{"remainingRequest":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js??ref--2-1!/Users/eve/development/force/src/mobile/analytics/impressions.js","dependencies":[{"path":"/Users/eve/development/force/src/mobile/analytics/impressions.js","mtime":1519227436000},{"path":"/Users/eve/development/force/.babelrc","mtime":1537178749000},{"path":"/Users/eve/development/force/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["(function () {\n  var enterModule = require('react-hot-loader').enterModule;\n\n  enterModule && enterModule(module);\n})();\n\nvar trackedIds = [];\n\nvar visibleArtworkIds = function visibleArtworkIds() {\n  // Find all of the \"artwork item\" components that are visible\n  var ids = $(\"a[href*='/artwork/'] img\").filter(function () {\n    var belowViewportTop = $(this).offset().top > $(window).scrollTop();\n    var aboveViewportBottom = $(this).offset().top + $(this).height() < $(window).scrollTop() + $(window).height();\n    return belowViewportTop && aboveViewportBottom;\n  }).map(function () {\n    return $(this).attr('data-id');\n  }).toArray(); // Add the artwork page as an impression\n\n  if ($('#artwork-page-main-image-container').length && sd.ARTWORK) ids.push(sd.ARTWORK._id); // Don't double track the same impressions\n\n  ids = _.difference(ids, trackedIds);\n  trackedIds = trackedIds.concat(ids); // Return only the new impressions\n\n  return ids;\n};\n\nvar trackImpressions = function trackImpressions() {\n  var ids = visibleArtworkIds();\n\n  if (ids.length > 0) {\n    analytics.track('Artwork impressions', {\n      ids: ids,\n      nonInteraction: 1\n    });\n  }\n};\n\ntrackImpressions();\n$(window).on('scroll', _.debounce(trackImpressions, 500));\n;\n\n(function () {\n  var reactHotLoader = require('react-hot-loader').default;\n\n  var leaveModule = require('react-hot-loader').leaveModule;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(trackedIds, \"trackedIds\", \"/Users/eve/development/force/src/mobile/analytics/impressions.js\");\n  reactHotLoader.register(visibleArtworkIds, \"visibleArtworkIds\", \"/Users/eve/development/force/src/mobile/analytics/impressions.js\");\n  reactHotLoader.register(trackImpressions, \"trackImpressions\", \"/Users/eve/development/force/src/mobile/analytics/impressions.js\");\n  leaveModule(module);\n})();\n\n;",{"version":3,"sources":["/Users/eve/development/force/src/mobile/analytics/impressions.js"],"names":["trackedIds","visibleArtworkIds","ids","$","filter","belowViewportTop","offset","top","window","scrollTop","aboveViewportBottom","height","map","attr","toArray","length","sd","ARTWORK","push","_id","_","difference","concat","trackImpressions","analytics","track","nonInteraction","on","debounce"],"mappings":";;;;;;AAAA,IAAIA,UAAU,GAAG,EAAjB;;AAEA,IAAIC,iBAAiB,GAAG,SAApBA,iBAAoB,GAAW;AACjC;AACA,MAAIC,GAAG,GAAGC,CAAC,CAAC,0BAAD,CAAD,CACPC,MADO,CACA,YAAW;AACjB,QAAIC,gBAAgB,GAAGF,CAAC,CAAC,IAAD,CAAD,CAAQG,MAAR,GAAiBC,GAAjB,GAAuBJ,CAAC,CAACK,MAAD,CAAD,CAAUC,SAAV,EAA9C;AACA,QAAIC,mBAAmB,GACrBP,CAAC,CAAC,IAAD,CAAD,CAAQG,MAAR,GAAiBC,GAAjB,GAAuBJ,CAAC,CAAC,IAAD,CAAD,CAAQQ,MAAR,EAAvB,GACAR,CAAC,CAACK,MAAD,CAAD,CAAUC,SAAV,KAAwBN,CAAC,CAACK,MAAD,CAAD,CAAUG,MAAV,EAF1B;AAGA,WAAON,gBAAgB,IAAIK,mBAA3B;AACD,GAPO,EAQPE,GARO,CAQH,YAAW;AACd,WAAOT,CAAC,CAAC,IAAD,CAAD,CAAQU,IAAR,CAAa,SAAb,CAAP;AACD,GAVO,EAWPC,OAXO,EAAV,CAFiC,CAejC;;AACA,MAAIX,CAAC,CAAC,oCAAD,CAAD,CAAwCY,MAAxC,IAAkDC,EAAE,CAACC,OAAzD,EACEf,GAAG,CAACgB,IAAJ,CAASF,EAAE,CAACC,OAAH,CAAWE,GAApB,EAjB+B,CAmBjC;;AACAjB,EAAAA,GAAG,GAAGkB,CAAC,CAACC,UAAF,CAAanB,GAAb,EAAkBF,UAAlB,CAAN;AACAA,EAAAA,UAAU,GAAGA,UAAU,CAACsB,MAAX,CAAkBpB,GAAlB,CAAb,CArBiC,CAuBjC;;AACA,SAAOA,GAAP;AACD,CAzBD;;AA2BA,IAAIqB,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAW;AAChC,MAAIrB,GAAG,GAAGD,iBAAiB,EAA3B;;AACA,MAAIC,GAAG,CAACa,MAAJ,GAAa,CAAjB,EAAoB;AAClBS,IAAAA,SAAS,CAACC,KAAV,CAAgB,qBAAhB,EAAuC;AAAEvB,MAAAA,GAAG,EAAEA,GAAP;AAAYwB,MAAAA,cAAc,EAAE;AAA5B,KAAvC;AACD;AACF,CALD;;AAOAH,gBAAgB;AAChBpB,CAAC,CAACK,MAAD,CAAD,CAAUmB,EAAV,CAAa,QAAb,EAAuBP,CAAC,CAACQ,QAAF,CAAWL,gBAAX,EAA6B,GAA7B,CAAvB;;;;;;;;;;;;0BArCIvB,U;0BAEAC,iB;0BA2BAsB,gB","sourcesContent":["var trackedIds = []\n\nvar visibleArtworkIds = function() {\n  // Find all of the \"artwork item\" components that are visible\n  var ids = $(\"a[href*='/artwork/'] img\")\n    .filter(function() {\n      var belowViewportTop = $(this).offset().top > $(window).scrollTop()\n      var aboveViewportBottom =\n        $(this).offset().top + $(this).height() <\n        $(window).scrollTop() + $(window).height()\n      return belowViewportTop && aboveViewportBottom\n    })\n    .map(function() {\n      return $(this).attr('data-id')\n    })\n    .toArray()\n\n  // Add the artwork page as an impression\n  if ($('#artwork-page-main-image-container').length && sd.ARTWORK)\n    ids.push(sd.ARTWORK._id)\n\n  // Don't double track the same impressions\n  ids = _.difference(ids, trackedIds)\n  trackedIds = trackedIds.concat(ids)\n\n  // Return only the new impressions\n  return ids\n}\n\nvar trackImpressions = function() {\n  var ids = visibleArtworkIds()\n  if (ids.length > 0) {\n    analytics.track('Artwork impressions', { ids: ids, nonInteraction: 1 })\n  }\n}\n\ntrackImpressions()\n$(window).on('scroll', _.debounce(trackImpressions, 500))\n"]}]}