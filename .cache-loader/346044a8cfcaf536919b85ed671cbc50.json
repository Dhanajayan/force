{"remainingRequest":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js??ref--2-1!/Users/eve/development/force/src/desktop/apps/consign/client/submission.js","dependencies":[{"path":"/Users/eve/development/force/src/desktop/apps/consign/client/submission.js","mtime":1521064654000},{"path":"/Users/eve/development/force/.babelrc","mtime":1528124541000},{"path":"/Users/eve/development/force/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js","mtime":1509489566000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _analytics_middleware = _interopRequireDefault(require(\"./analytics_middleware\"));\n\nvar _responsive_window = _interopRequireDefault(require(\"../../../components/react/responsive_window\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _submission_flow = _interopRequireDefault(require(\"../components/submission_flow\"));\n\nvar _index = _interopRequireDefault(require(\"../../../components/geo/index.coffee\"));\n\nvar _reducers = _interopRequireDefault(require(\"./reducers\"));\n\nvar _createBrowserHistory = _interopRequireDefault(require(\"history/createBrowserHistory\"));\n\nvar _reduxLogger = _interopRequireDefault(require(\"redux-logger\"));\n\nvar _steps_config = _interopRequireDefault(require(\"./steps_config\"));\n\nvar _reduxThunk = _interopRequireDefault(require(\"redux-thunk\"));\n\nvar _reactRedux = require(\"react-redux\");\n\nvar _reactRouter = require(\"react-router\");\n\nvar _redux = require(\"redux\");\n\nvar _sharify = require(\"sharify\");\n\nvar _actions = require(\"./actions\");\n\nvar _reactDom = require(\"react-dom\");\n\nvar _reactRouterRedux = require(\"react-router-redux\");\n\nfunction setupSubmissionFlow() {\n  // load google maps for autocomplete\n  _index.default.loadGoogleMaps();\n\n  var history = (0, _createBrowserHistory.default)();\n  var middleware = [];\n  middleware.push(_reduxThunk.default); // lets us dispatch() functions\n\n  middleware.push((0, _reactRouterRedux.routerMiddleware)(history));\n  middleware.push(_analytics_middleware.default); // middleware to help us track previous and future states\n\n  if (_sharify.data.NODE_ENV === 'development' || _sharify.data.NODE_ENV === 'staging') {\n    middleware.push((0, _reduxLogger.default)({\n      // middleware that logs actions\n      collapsed: true\n    }));\n  }\n\n  var store = (0, _redux.createStore)(_reducers.default, _redux.applyMiddleware.apply(void 0, middleware));\n\n  var determineSteps = function determineSteps() {\n    if (_sharify.data.CURRENT_USER) {\n      store.dispatch((0, _actions.updateStepsWithUser)());\n    } else {\n      store.dispatch((0, _actions.updateStepsWithoutUser)());\n    }\n  }; // track pageviews when react-router updates the url\n\n\n  history.listen(function (ev) {\n    window.analytics.page({\n      path: ev.pathname\n    }, {\n      integrations: {\n        Marketo: false\n      }\n    });\n  });\n  (0, _reactDom.render)(_react.default.createElement(_reactRedux.Provider, {\n    store: store\n  }, _react.default.createElement(_responsive_window.default, null, _react.default.createElement(_reactRouter.Router, {\n    history: history\n  }, _react.default.createElement(_reactRouter.Switch, null, _react.default.createElement(_reactRouter.Route, {\n    exact: true,\n    path: \"/consign/submission\",\n    render: function render() {\n      if (_sharify.data.CURRENT_USER) {\n        store.dispatch((0, _actions.updateStepsWithUser)());\n        return _react.default.createElement(_reactRouter.Redirect, {\n          to: _steps_config.default.chooseArtist.path\n        });\n      } else {\n        store.dispatch((0, _actions.updateStepsWithoutUser)());\n        return _react.default.createElement(_reactRouter.Redirect, {\n          to: _steps_config.default.createAccount.path\n        });\n      }\n    }\n  }), _react.default.createElement(_reactRouter.Route, {\n    path: _steps_config.default.createAccount.path,\n    render: function render() {\n      store.dispatch((0, _actions.updateStepsWithoutUser)());\n      store.dispatch((0, _actions.updateCurrentStep)('createAccount'));\n      return _react.default.createElement(_submission_flow.default, null);\n    }\n  }), _react.default.createElement(_reactRouter.Route, {\n    path: _steps_config.default.chooseArtist.path,\n    render: function render() {\n      determineSteps();\n      store.dispatch((0, _actions.updateCurrentStep)('chooseArtist'));\n      return _react.default.createElement(_submission_flow.default, null);\n    }\n  }), _react.default.createElement(_reactRouter.Route, {\n    path: _steps_config.default.describeWork.path,\n    render: function render() {\n      determineSteps();\n      store.dispatch((0, _actions.updateCurrentStep)('describeWork'));\n      return _react.default.createElement(_submission_flow.default, null);\n    }\n  }), _react.default.createElement(_reactRouter.Route, {\n    path: _steps_config.default.uploadPhotos.submissionPath,\n    render: function render() {\n      determineSteps();\n      store.dispatch((0, _actions.updateCurrentStep)('uploadPhotos'));\n      return _react.default.createElement(_submission_flow.default, null);\n    }\n  }), _react.default.createElement(_reactRouter.Route, {\n    path: _steps_config.default.describeWork.submissionPath,\n    render: function render() {\n      determineSteps();\n      store.dispatch((0, _actions.updateCurrentStep)('describeWork'));\n      store.dispatch((0, _actions.updateLocationFromSubmissionAndFreeze)());\n      return _react.default.createElement(_submission_flow.default, null);\n    }\n  }), _react.default.createElement(_reactRouter.Route, {\n    path: _steps_config.default.uploadLanding.submissionPath,\n    render: function render() {\n      var Component = _steps_config.default.uploadLanding.component;\n      store.dispatch((0, _actions.updateAuthFormStateAndClearError)('logIn'));\n      store.dispatch((0, _actions.ignoreRedirectOnAuth)());\n      return _react.default.createElement(Component, null);\n    }\n  }), _react.default.createElement(_reactRouter.Route, {\n    path: _steps_config.default.thankYou.submissionPath,\n    component: _steps_config.default.thankYou.component\n  }))))), document.getElementById('consignments-submission__flow'));\n}\n\nvar _default = function _default() {\n  setupSubmissionFlow();\n};\n\nexports.default = _default;",{"version":3,"sources":["src/desktop/apps/consign/client/submission.js"],"names":["setupSubmissionFlow","loadGoogleMaps","history","middleware","push","NODE_ENV","collapsed","store","determineSteps","CURRENT_USER","dispatch","listen","ev","window","analytics","page","path","pathname","integrations","Marketo","chooseArtist","createAccount","describeWork","uploadPhotos","submissionPath","uploadLanding","Component","component","thankYou","document","getElementById"],"mappings":"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","file":"/Users/eve/development/force/src/desktop/apps/consign/client/submission.js","sourceRoot":"/Users/eve/development/force","sourcesContent":["import analyticsMiddleware from './analytics_middleware'\nimport ResponsiveWindow from '../../../components/react/responsive_window'\nimport React from 'react'\nimport SubmissionFlow from '../components/submission_flow'\nimport geo from '../../../components/geo/index.coffee'\nimport reducers from './reducers'\nimport createHistory from 'history/createBrowserHistory'\nimport createLogger from 'redux-logger'\nimport stepsConfig from './steps_config'\nimport thunkMiddleware from 'redux-thunk'\nimport { Provider } from 'react-redux'\nimport { Redirect, Router, Route, Switch } from 'react-router'\nimport { createStore, applyMiddleware } from 'redux'\nimport { data as sd } from 'sharify'\nimport {\n  ignoreRedirectOnAuth,\n  updateAuthFormStateAndClearError,\n  updateCurrentStep,\n  updateLocationFromSubmissionAndFreeze,\n  updateStepsWithUser,\n  updateStepsWithoutUser,\n} from './actions'\nimport { render } from 'react-dom'\nimport { routerMiddleware } from 'react-router-redux'\n\nfunction setupSubmissionFlow() {\n  // load google maps for autocomplete\n  geo.loadGoogleMaps()\n  const history = createHistory()\n\n  const middleware = []\n\n  middleware.push(thunkMiddleware) // lets us dispatch() functions\n  middleware.push(routerMiddleware(history))\n  middleware.push(analyticsMiddleware) // middleware to help us track previous and future states\n\n  if (sd.NODE_ENV === 'development' || sd.NODE_ENV === 'staging') {\n    middleware.push(\n      createLogger({\n        // middleware that logs actions\n        collapsed: true,\n      })\n    )\n  }\n\n  const store = createStore(reducers, applyMiddleware(...middleware))\n\n  const determineSteps = () => {\n    if (sd.CURRENT_USER) {\n      store.dispatch(updateStepsWithUser())\n    } else {\n      store.dispatch(updateStepsWithoutUser())\n    }\n  }\n\n  // track pageviews when react-router updates the url\n  history.listen((ev) => {\n    window.analytics.page(\n      { path: ev.pathname },\n      { integrations: { Marketo: false } }\n    )\n  })\n\n  render(\n    <Provider store={store}>\n      <ResponsiveWindow>\n        <Router history={history}>\n          <Switch>\n            <Route\n              exact\n              path=\"/consign/submission\"\n              render={() => {\n                if (sd.CURRENT_USER) {\n                  store.dispatch(updateStepsWithUser())\n                  return <Redirect to={stepsConfig.chooseArtist.path} />\n                } else {\n                  store.dispatch(updateStepsWithoutUser())\n                  return <Redirect to={stepsConfig.createAccount.path} />\n                }\n              }}\n            />\n            <Route\n              path={stepsConfig.createAccount.path}\n              render={() => {\n                store.dispatch(updateStepsWithoutUser())\n                store.dispatch(updateCurrentStep('createAccount'))\n                return <SubmissionFlow />\n              }}\n            />\n            <Route\n              path={stepsConfig.chooseArtist.path}\n              render={() => {\n                determineSteps()\n                store.dispatch(updateCurrentStep('chooseArtist'))\n                return <SubmissionFlow />\n              }}\n            />\n            <Route\n              path={stepsConfig.describeWork.path}\n              render={() => {\n                determineSteps()\n                store.dispatch(updateCurrentStep('describeWork'))\n                return <SubmissionFlow />\n              }}\n            />\n            <Route\n              path={stepsConfig.uploadPhotos.submissionPath}\n              render={() => {\n                determineSteps()\n                store.dispatch(updateCurrentStep('uploadPhotos'))\n                return <SubmissionFlow />\n              }}\n            />\n            <Route\n              path={stepsConfig.describeWork.submissionPath}\n              render={() => {\n                determineSteps()\n                store.dispatch(updateCurrentStep('describeWork'))\n                store.dispatch(updateLocationFromSubmissionAndFreeze())\n                return <SubmissionFlow />\n              }}\n            />\n            <Route\n              path={stepsConfig.uploadLanding.submissionPath}\n              render={() => {\n                const Component = stepsConfig.uploadLanding.component\n                store.dispatch(updateAuthFormStateAndClearError('logIn'))\n                store.dispatch(ignoreRedirectOnAuth())\n                return <Component />\n              }}\n            />\n            <Route\n              path={stepsConfig.thankYou.submissionPath}\n              component={stepsConfig.thankYou.component}\n            />\n          </Switch>\n        </Router>\n      </ResponsiveWindow>\n    </Provider>,\n    document.getElementById('consignments-submission__flow')\n  )\n}\n\nexport default () => {\n  setupSubmissionFlow()\n}\n"]}]}