{"remainingRequest":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js??ref--2-1!/Users/eve/development/force/src/desktop/apps/auth2/components/ModalContainer.tsx","dependencies":[{"path":"/Users/eve/development/force/src/desktop/apps/auth2/components/ModalContainer.tsx","mtime":1531775403000},{"path":"/Users/eve/development/force/.babelrc","mtime":1528124541000},{"path":"/Users/eve/development/force/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js","mtime":1509489566000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ModalContainer = void 0;\n\nvar _stringify = _interopRequireDefault(require(\"@babel/runtime/core-js/json/stringify\"));\n\nvar _cookiesJs = _interopRequireDefault(require(\"cookies-js\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _ModalManager = require(\"@artsy/reaction/dist/Components/Authentication/Desktop/ModalManager\");\n\nvar _helpers = require(\"../helpers\");\n\nvar _sharify = require(\"sharify\");\n\nvar mediator = require(\"../../../lib/mediator.coffee\");\n\nvar ModalContainer = function ModalContainer() {\n  var manager;\n  mediator.on('open:auth', function (options) {\n    options.destination = options.destination || location.href;\n    (0, _helpers.setCookies)(options);\n\n    if (options && options.mode === 'register') {\n      options.mode = 'signup';\n    }\n\n    setTimeout(function () {\n      if (manager) {\n        manager.openModal(options);\n      }\n    }, document.readyState === 'complete' ? 0 : 500);\n  });\n  mediator.on('auth:error', function (err) {\n    if (manager) {\n      manager.setError(err);\n    }\n  });\n  return _react.default.createElement(_ModalManager.ModalManager, {\n    ref: function ref(_ref) {\n      return manager = _ref;\n    },\n    submitUrls: {\n      login: _sharify.data.AP.loginPagePath,\n      signup: _sharify.data.AP.signupPagePath,\n      facebook: _sharify.data.AP.facebookPath,\n      twitter: _sharify.data.AP.twitterPath\n    },\n    csrf: _sharify.data.CSRF_TOKEN,\n    handleSubmit: _helpers.handleSubmit,\n    onSocialAuthEvent: function onSocialAuthEvent(data) {\n      var analyticsOptions = {\n        action: data.mode === 'signup' ? 'Created account' : 'Successfully logged in',\n        type: data.mode,\n        context_module: data.contextModule,\n        modal_copy: data.copy,\n        trigger: data.trigger || 'click',\n        trigger_seconds: data.triggerSeconds,\n        intent: data.intent,\n        auth_redirect: data.redirectTo || data.destination,\n        service: data.service\n      };\n\n      _cookiesJs.default.set(\"analytics-\".concat(data.mode), (0, _stringify.default)(analyticsOptions), {\n        expires: 60 * 60 * 24\n      });\n    }\n  });\n};\n\nexports.ModalContainer = ModalContainer;",{"version":3,"sources":["src/desktop/apps/auth2/components/ModalContainer.tsx"],"names":["mediator","require","ModalContainer","manager","on","options","destination","location","href","mode","setTimeout","openModal","document","readyState","setError","err","ref","login","AP","loginPagePath","signup","signupPagePath","facebook","facebookPath","twitter","twitterPath","CSRF_TOKEN","analyticsOptions","action","data","type","context_module","contextModule","modal_copy","copy","trigger","trigger_seconds","triggerSeconds","intent","auth_redirect","redirectTo","service","set","expires"],"mappings":";;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA,IAAMA,WAAWC,uCAAjB;;AAEO,IAAMC,iBAAiC,SAAjCA,cAAiC,GAAM;AAClD,MAAIC,OAAJ;AAEAH,WAASI,EAAT,CAAY,WAAZ,EAAyB,mBAAW;AAClCC,YAAQC,WAAR,GAAsBD,QAAQC,WAAR,IAAuBC,SAASC,IAAtD;AAEA,6BAAWH,OAAX;;AAEA,QAAIA,WAAWA,QAAQI,IAAR,KAAiB,UAAhC,EAA4C;AAC1CJ,cAAQI,IAAR,GAAe,QAAf;AACD;;AAEDC,eAAW,YAAM;AACf,UAAIP,OAAJ,EAAa;AACXA,gBAAQQ,SAAR,CAAkBN,OAAlB;AACD;AACF,KAJD,EAIGO,SAASC,UAAT,KAAwB,UAAxB,GAAqC,CAArC,GAAyC,GAJ5C;AAKD,GAdD;AAgBAb,WAASI,EAAT,CAAY,YAAZ,EAA0B,eAAO;AAC/B,QAAID,OAAJ,EAAa;AACXA,cAAQW,QAAR,CAAiBC,GAAjB;AACD;AACF,GAJD;AAMA,SACE;AACE,SAAK;AAAA,aAAQZ,UAAUa,IAAlB;AAAA,KADP;AAEE,gBAAY;AACVC,aAAO,cAAGC,EAAH,CAAMC,aADH;AAEVC,cAAQ,cAAGF,EAAH,CAAMG,cAFJ;AAGVC,gBAAU,cAAGJ,EAAH,CAAMK,YAHN;AAIVC,eAAS,cAAGN,EAAH,CAAMO;AAJL,KAFd;AAQE,UAAM,cAAGC,UARX;AASE,uCATF;AAUE,uBAAmB,iCAAQ;AACzB,UAAMC,mBAAmB;AACvBC,gBACEC,KAAKpB,IAAL,KAAc,QAAd,GACI,iBADJ,GAEI,wBAJiB;AAKvBqB,cAAMD,KAAKpB,IALY;AAMvBsB,wBAAgBF,KAAKG,aANE;AAOvBC,oBAAYJ,KAAKK,IAPM;AAQvBC,iBAASN,KAAKM,OAAL,IAAgB,OARF;AASvBC,yBAAiBP,KAAKQ,cATC;AAUvBC,gBAAQT,KAAKS,MAVU;AAWvBC,uBAAeV,KAAKW,UAAL,IAAmBX,KAAKvB,WAXhB;AAYvBmC,iBAASZ,KAAKY;AAZS,OAAzB;;AAeA,yBAAQC,GAAR,qBACeb,KAAKpB,IADpB,GAEE,wBAAekB,gBAAf,CAFF,EAGE;AACEgB,iBAAS,KAAK,EAAL,GAAU;AADrB,OAHF;AAOD;AAjCH,IADF;AAqCD,CA9DM","file":"/Users/eve/development/force/src/desktop/apps/auth2/components/ModalContainer.tsx","sourceRoot":"/Users/eve/development/force","sourcesContent":["import Cookies from 'cookies-js'\nimport React from 'react'\nimport { ModalManager } from '@artsy/reaction/dist/Components/Authentication/Desktop/ModalManager'\nimport { handleSubmit, setCookies } from '../helpers'\nimport { data as sd } from 'sharify'\nconst mediator = require('../../../lib/mediator.coffee')\n\nexport const ModalContainer: React.SFC<any> = () => {\n  let manager: ModalManager | null\n\n  mediator.on('open:auth', options => {\n    options.destination = options.destination || location.href\n\n    setCookies(options)\n\n    if (options && options.mode === 'register') {\n      options.mode = 'signup'\n    }\n\n    setTimeout(() => {\n      if (manager) {\n        manager.openModal(options)\n      }\n    }, document.readyState === 'complete' ? 0 : 500)\n  })\n\n  mediator.on('auth:error', err => {\n    if (manager) {\n      manager.setError(err)\n    }\n  })\n\n  return (\n    <ModalManager\n      ref={ref => (manager = ref)}\n      submitUrls={{\n        login: sd.AP.loginPagePath,\n        signup: sd.AP.signupPagePath,\n        facebook: sd.AP.facebookPath,\n        twitter: sd.AP.twitterPath,\n      }}\n      csrf={sd.CSRF_TOKEN}\n      handleSubmit={handleSubmit as any}\n      onSocialAuthEvent={data => {\n        const analyticsOptions = {\n          action:\n            data.mode === 'signup'\n              ? 'Created account'\n              : 'Successfully logged in',\n          type: data.mode,\n          context_module: data.contextModule,\n          modal_copy: data.copy,\n          trigger: data.trigger || 'click',\n          trigger_seconds: data.triggerSeconds,\n          intent: data.intent,\n          auth_redirect: data.redirectTo || data.destination,\n          service: data.service,\n        }\n\n        Cookies.set(\n          `analytics-${data.mode}`,\n          JSON.stringify(analyticsOptions),\n          {\n            expires: 60 * 60 * 24,\n          }\n        )\n      }}\n    />\n  )\n}\n"]}]}