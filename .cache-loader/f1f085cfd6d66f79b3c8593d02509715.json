{"remainingRequest":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js??ref--2-1!/Users/eve/development/force/src/mobile/analytics/impressions.js","dependencies":[{"path":"/Users/eve/development/force/src/mobile/analytics/impressions.js","mtime":1519227436000},{"path":"/Users/eve/development/force/.babelrc","mtime":1528124541000},{"path":"/Users/eve/development/force/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js","mtime":1509489566000}],"contextDependencies":[],"result":["var trackedIds = [];\n\nvar visibleArtworkIds = function visibleArtworkIds() {\n  // Find all of the \"artwork item\" components that are visible\n  var ids = $(\"a[href*='/artwork/'] img\").filter(function () {\n    var belowViewportTop = $(this).offset().top > $(window).scrollTop();\n    var aboveViewportBottom = $(this).offset().top + $(this).height() < $(window).scrollTop() + $(window).height();\n    return belowViewportTop && aboveViewportBottom;\n  }).map(function () {\n    return $(this).attr('data-id');\n  }).toArray(); // Add the artwork page as an impression\n\n  if ($('#artwork-page-main-image-container').length && sd.ARTWORK) ids.push(sd.ARTWORK._id); // Don't double track the same impressions\n\n  ids = _.difference(ids, trackedIds);\n  trackedIds = trackedIds.concat(ids); // Return only the new impressions\n\n  return ids;\n};\n\nvar trackImpressions = function trackImpressions() {\n  var ids = visibleArtworkIds();\n\n  if (ids.length > 0) {\n    analytics.track('Artwork impressions', {\n      ids: ids,\n      nonInteraction: 1\n    });\n  }\n};\n\ntrackImpressions();\n$(window).on('scroll', _.debounce(trackImpressions, 500));",{"version":3,"sources":["src/mobile/analytics/impressions.js"],"names":["trackedIds","visibleArtworkIds","ids","$","filter","belowViewportTop","offset","top","window","scrollTop","aboveViewportBottom","height","map","attr","toArray","length","sd","ARTWORK","push","_id","_","difference","concat","trackImpressions","analytics","track","nonInteraction","on","debounce"],"mappings":"AAAA,IAAIA,aAAa,EAAjB;;AAEA,IAAIC,oBAAoB,SAApBA,iBAAoB,GAAW;AACjC;AACA,MAAIC,MAAMC,EAAE,0BAAF,EACPC,MADO,CACA,YAAW;AACjB,QAAIC,mBAAmBF,EAAE,IAAF,EAAQG,MAAR,GAAiBC,GAAjB,GAAuBJ,EAAEK,MAAF,EAAUC,SAAV,EAA9C;AACA,QAAIC,sBACFP,EAAE,IAAF,EAAQG,MAAR,GAAiBC,GAAjB,GAAuBJ,EAAE,IAAF,EAAQQ,MAAR,EAAvB,GACAR,EAAEK,MAAF,EAAUC,SAAV,KAAwBN,EAAEK,MAAF,EAAUG,MAAV,EAF1B;AAGA,WAAON,oBAAoBK,mBAA3B;AACD,GAPO,EAQPE,GARO,CAQH,YAAW;AACd,WAAOT,EAAE,IAAF,EAAQU,IAAR,CAAa,SAAb,CAAP;AACD,GAVO,EAWPC,OAXO,EAAV,CAFiC,CAejC;;AACA,MAAIX,EAAE,oCAAF,EAAwCY,MAAxC,IAAkDC,GAAGC,OAAzD,EACEf,IAAIgB,IAAJ,CAASF,GAAGC,OAAH,CAAWE,GAApB,EAjB+B,CAmBjC;;AACAjB,QAAMkB,EAAEC,UAAF,CAAanB,GAAb,EAAkBF,UAAlB,CAAN;AACAA,eAAaA,WAAWsB,MAAX,CAAkBpB,GAAlB,CAAb,CArBiC,CAuBjC;;AACA,SAAOA,GAAP;AACD,CAzBD;;AA2BA,IAAIqB,mBAAmB,SAAnBA,gBAAmB,GAAW;AAChC,MAAIrB,MAAMD,mBAAV;;AACA,MAAIC,IAAIa,MAAJ,GAAa,CAAjB,EAAoB;AAClBS,cAAUC,KAAV,CAAgB,qBAAhB,EAAuC;AAAEvB,WAAKA,GAAP;AAAYwB,sBAAgB;AAA5B,KAAvC;AACD;AACF,CALD;;AAOAH;AACApB,EAAEK,MAAF,EAAUmB,EAAV,CAAa,QAAb,EAAuBP,EAAEQ,QAAF,CAAWL,gBAAX,EAA6B,GAA7B,CAAvB","file":"/Users/eve/development/force/src/mobile/analytics/impressions.js","sourceRoot":"/Users/eve/development/force","sourcesContent":["var trackedIds = []\n\nvar visibleArtworkIds = function() {\n  // Find all of the \"artwork item\" components that are visible\n  var ids = $(\"a[href*='/artwork/'] img\")\n    .filter(function() {\n      var belowViewportTop = $(this).offset().top > $(window).scrollTop()\n      var aboveViewportBottom =\n        $(this).offset().top + $(this).height() <\n        $(window).scrollTop() + $(window).height()\n      return belowViewportTop && aboveViewportBottom\n    })\n    .map(function() {\n      return $(this).attr('data-id')\n    })\n    .toArray()\n\n  // Add the artwork page as an impression\n  if ($('#artwork-page-main-image-container').length && sd.ARTWORK)\n    ids.push(sd.ARTWORK._id)\n\n  // Don't double track the same impressions\n  ids = _.difference(ids, trackedIds)\n  trackedIds = trackedIds.concat(ids)\n\n  // Return only the new impressions\n  return ids\n}\n\nvar trackImpressions = function() {\n  var ids = visibleArtworkIds()\n  if (ids.length > 0) {\n    analytics.track('Artwork impressions', { ids: ids, nonInteraction: 1 })\n  }\n}\n\ntrackImpressions()\n$(window).on('scroll', _.debounce(trackImpressions, 500))\n"]}]}