{"remainingRequest":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js??ref--2-1!/Users/eve/development/force/src/desktop/lib/middleware/renderArtworkBrick.js","dependencies":[{"path":"/Users/eve/development/force/src/desktop/lib/middleware/renderArtworkBrick.js","mtime":1524596640000},{"path":"/Users/eve/development/force/.babelrc","mtime":1523548621000},{"path":"/Users/eve/development/force/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js","mtime":1509489566000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ReactionRenderer = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _reactDom = _interopRequireDefault(require(\"react-dom\"));\n\nvar _Artwork = require(\"@artsy/reaction/dist/Components/Artwork\");\n\nvar _ArtworkGrid = require(\"@artsy/reaction/dist/Components/ArtworkGrid\");\n\nvar _Fillwidth = require(\"@artsy/reaction/dist/Components/Artwork/Fillwidth\");\n\nvar _styledComponents = require(\"styled-components\");\n\nvar _server = require(\"react-dom/server\");\n\nvar _lodash = require(\"lodash\");\n\nvar ReactionRenderer =\n/*#__PURE__*/\nfunction () {\n  function ReactionRenderer() {\n    var mode = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'server';\n    var res = arguments.length > 1 ? arguments[1] : undefined;\n    (0, _classCallCheck2.default)(this, ReactionRenderer);\n    Object.defineProperty(this, \"id\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"mode\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"type\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"res\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"props\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: void 0\n    });\n    this.mode = mode;\n    this.res = res;\n  }\n\n  (0, _createClass2.default)(ReactionRenderer, [{\n    key: \"artworkBrick\",\n    value: function artworkBrick(props) {\n      this.type = this.artworkBrick.name;\n      var html = this.render(function (props) {\n        return _react.default.createElement(_Artwork.Artwork, {\n          artwork: artwork,\n          useRelay: false\n        });\n      });\n      return html;\n    }\n  }, {\n    key: \"artworkGrid\",\n    value: function artworkGrid(props) {\n      this.type = this.artworkGrid.name;\n      var html = this.render(function (props) {\n        return _react.default.createElement(_ArtworkGrid.ArtworkGrid, {\n          columnCount: 2,\n          artworks: artworks,\n          useRelay: false\n        });\n      });\n      return html;\n    }\n  }, {\n    key: \"fillWidth\",\n    value: function fillWidth(props) {\n      this.type = this.fillWidth.name;\n      var html = this.render(function (props) {\n        return _react.default.createElement(_Fillwidth.Fillwidth, {\n          artworks: artworks,\n          useRelay: false\n        });\n      });\n      return html;\n    }\n    /**\n     * Sharify automatically passes over data to the client. Once render is called\n     * on the server append block and wait for client-side mount, which will then\n     * deserialize and rehydrate.\n     */\n\n  }, {\n    key: \"addToQueue\",\n    value: function addToQueue(block) {\n      try {\n        this.res.locals.sharify.data.reactionBlocks.push(block);\n      } catch (error) {\n        console.error('(middlware/renderArtworkBrick) Error adding to queue:', error);\n      }\n    }\n  }, {\n    key: \"serialize\",\n    value: function serialize() {\n      this.addToQueue({\n        mode: this.mode,\n        id: this.id,\n        type: this.type,\n        props: this.props\n      });\n    }\n  }, {\n    key: \"deserialize\",\n    value: function deserialize(block) {\n      this.mode = 'client';\n      this.id = block.id;\n      this.type = block.type;\n      this.props = block.props;\n      var blockType = this[this.type].bind(this);\n\n      if ((0, _lodash.isFunction)(blockType)) {\n        blockType(this.props);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render(blockType) {\n      try {\n        var isServer = this.mode === 'server';\n\n        if (isServer) {\n          this.id = (0, _lodash.uniqueId)('react-mount-reaction-');\n          var sheet = new _styledComponents.ServerStyleSheet();\n          var html = (0, _server.renderToString)(sheet.collectStyles(blockType(this.props)));\n          var css = sheet.getStyleTags();\n          this.serialize();\n          var out = [\"<div id=\".concat(this.id, \"></div>\"), css, html].join('\\n');\n          return out; // Client-side\n        } else {\n          _reactDom.default.hydrate(blockType(this.props), document.getElementById(this.id));\n        }\n      } catch (error) {\n        console.error('(middleware/renderArtworkBrick) Error rendering server-side: ', error);\n      }\n    }\n  }]);\n  return ReactionRenderer;\n}();\n\nexports.ReactionRenderer = ReactionRenderer;\n\nmodule.exports.serverRenderer = function (req, res, next) {\n  var renderer = new ReactionRenderer('server', res);\n  res.locals.reaction = renderer;\n  res.locals.sharify.data.reactionBlocks = [];\n  next();\n}; // Fixtures: FIXME: (move)\n\n\nvar artwork = {\n  id: 'mikael-olson-some-kind-of-dinosaur',\n  title: 'Some Kind of Dinosaur',\n  date: '2015',\n  sale_message: '$875',\n  is_in_auction: false,\n  image: {\n    placeholder: 200,\n    // only required prop\n    url: 'https://d32dm0rphc51dk.cloudfront.net/w6h1rYqIqhhCRE5f0_fxMQ/larger.jpg',\n    aspect_ratio: 0.74\n  },\n  artists: [{\n    __id: 'mikael-olson',\n    name: 'Mikael Olson'\n  }],\n  partner: {\n    name: 'Gallery 1261'\n  },\n  href: '/artwork/mikael-olson-some-kind-of-dinosaur'\n};\nvar artworks = {\n  edges: [{\n    node: {\n      __id: 'QXJ0d29yazpiYW5rc3ktd2UtbG92ZS15b3Utc28tbG92ZS11cw==',\n      image: {\n        aspect_ratio: 1,\n        placeholder: '100%',\n        url: 'https://d32dm0rphc51dk.cloudfront.net/hoFocUdpgF4mazPIgekpZA/large.jpg'\n      },\n      href: '/artwork/banksy-we-love-you-so-love-us',\n      title: 'We Love You So Love Us',\n      date: '2000',\n      sale_message: 'Contact For Price',\n      cultural_maker: null,\n      artists: [{\n        __id: 'QXJ0aXN0OmJhbmtzeQ==',\n        href: '/artist/banksy',\n        name: 'Banksy'\n      }],\n      collecting_institution: null,\n      partner: {\n        name: 'EHC Fine Art',\n        href: '/ehc-fine-art',\n        __id: 'UGFydG5lcjplaGMtZmluZS1hcnQ=',\n        type: 'Gallery'\n      },\n      sale: null,\n      _id: '58e1a19d275b247d353ff0d9',\n      is_inquireable: true,\n      sale_artwork: null,\n      id: 'banksy-we-love-you-so-love-us',\n      is_saved: null\n    }\n  }, {\n    node: {\n      __id: 'QXJ0d29yazpiYW5rc3ktcmFkYXItcmF0LWRpcnR5LWZ1bmtlci1scA==',\n      image: {\n        aspect_ratio: 1,\n        placeholder: '100%',\n        url: 'https://d32dm0rphc51dk.cloudfront.net/NQvnb87U8oGDm6kpdJ9jLA/large.jpg'\n      },\n      href: '/artwork/banksy-radar-rat-dirty-funker-lp',\n      title: 'Radar Rat (Dirty Funker LP)',\n      date: '2008',\n      sale_message: '$950',\n      cultural_maker: null,\n      artists: [{\n        __id: 'QXJ0aXN0OmJhbmtzeQ==',\n        href: '/artist/banksy',\n        name: 'Banksy'\n      }],\n      collecting_institution: null,\n      partner: {\n        name: 'EHC Fine Art',\n        href: '/ehc-fine-art',\n        __id: 'UGFydG5lcjplaGMtZmluZS1hcnQ=',\n        type: 'Gallery'\n      },\n      sale: null,\n      _id: '58e1a19ecd530e4d612cb07f',\n      is_inquireable: true,\n      sale_artwork: null,\n      id: 'banksy-radar-rat-dirty-funker-lp',\n      is_saved: null\n    }\n  }, {\n    node: {\n      __id: 'QXJ0d29yazpiYW5rc3ktZmxvd2VyLWJvbWJlci1ieS1icmFuZGFsaXNt',\n      image: {\n        aspect_ratio: 1.5,\n        placeholder: '66.66666666666666%',\n        url: 'https://d32dm0rphc51dk.cloudfront.net/88LaQZxzQdksn76f0LGFoQ/large.jpg'\n      },\n      href: '/artwork/banksy-flower-bomber-by-brandalism',\n      title: 'Flower Bomber (by Brandalism)',\n      date: 'ca. 2017',\n      sale_message: 'Contact For Price',\n      cultural_maker: null,\n      artists: [{\n        __id: 'QXJ0aXN0OmJhbmtzeQ==',\n        href: '/artist/banksy',\n        name: 'Banksy'\n      }],\n      collecting_institution: null,\n      partner: {\n        name: 'EHC Fine Art',\n        href: '/ehc-fine-art',\n        __id: 'UGFydG5lcjplaGMtZmluZS1hcnQ=',\n        type: 'Gallery'\n      },\n      sale: null,\n      _id: '58e1a19f275b247d353ff0e2',\n      is_inquireable: true,\n      sale_artwork: null,\n      id: 'banksy-flower-bomber-by-brandalism',\n      is_saved: null\n    }\n  }, {\n    node: {\n      __id: 'QXJ0d29yazpiYW5rc3ktZ2lybC13aXRoLWJhbGxvb24tMTQ=',\n      image: {\n        aspect_ratio: 0.75,\n        placeholder: '132.9%',\n        url: 'https://d32dm0rphc51dk.cloudfront.net/RRGE9Ild18_IPghZXT6wuQ/large.jpg'\n      },\n      href: '/artwork/banksy-girl-with-balloon-14',\n      title: 'Girl With Balloon',\n      date: '2004',\n      sale_message: 'Contact For Price',\n      cultural_maker: null,\n      artists: [{\n        __id: 'QXJ0aXN0OmJhbmtzeQ==',\n        href: '/artist/banksy',\n        name: 'Banksy'\n      }],\n      collecting_institution: null,\n      partner: {\n        name: 'Graffik Gallery / Banksy Editions',\n        href: '/graffik-gallery-slash-banksy-editions',\n        __id: 'UGFydG5lcjpncmFmZmlrLWdhbGxlcnktc2xhc2gtYmFua3N5LWVkaXRpb25z',\n        type: 'Gallery'\n      },\n      sale: null,\n      _id: '58e370659c18db774f25ed5b',\n      is_inquireable: true,\n      sale_artwork: null,\n      id: 'banksy-girl-with-balloon-14',\n      is_saved: null\n    }\n  }]\n};",{"version":3,"sources":["src/desktop/lib/middleware/renderArtworkBrick.js"],"names":["ReactionRenderer","mode","res","props","type","artworkBrick","name","html","render","artwork","artworkGrid","artworks","fillWidth","block","locals","sharify","data","reactionBlocks","push","error","console","addToQueue","id","blockType","bind","isServer","sheet","collectStyles","css","getStyleTags","serialize","out","join","hydrate","document","getElementById","module","exports","serverRenderer","req","next","renderer","reaction","title","date","sale_message","is_in_auction","image","placeholder","url","aspect_ratio","artists","__id","partner","href","edges","node","cultural_maker","collecting_institution","sale","_id","is_inquireable","sale_artwork","is_saved"],"mappings":"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","file":"/Users/eve/development/force/src/desktop/lib/middleware/renderArtworkBrick.js","sourceRoot":"/Users/eve/development/force","sourcesContent":["import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { Artwork } from 'reaction/Components/Artwork'\nimport { ArtworkGrid } from 'reaction/Components/ArtworkGrid'\nimport { Fillwidth } from 'reaction/Components/Artwork/Fillwidth'\nimport { ServerStyleSheet } from 'styled-components'\nimport { renderToString } from 'react-dom/server'\nimport { isFunction, uniqueId } from 'lodash'\n\nexport class ReactionRenderer {\n  id\n  mode\n  type\n  res\n  props\n\n  constructor(mode = 'server', res) {\n    this.mode = mode\n    this.res = res\n  }\n\n  artworkBrick(props) {\n    this.type = this.artworkBrick.name\n\n    const html = this.render(props => {\n      return <Artwork artwork={artwork} useRelay={false} />\n    })\n    return html\n  }\n\n  artworkGrid(props) {\n    this.type = this.artworkGrid.name\n\n    const html = this.render(props => {\n      return (\n        <ArtworkGrid columnCount={2} artworks={artworks} useRelay={false} />\n      )\n    })\n    return html\n  }\n\n  fillWidth(props) {\n    this.type = this.fillWidth.name\n\n    const html = this.render(props => {\n      return <Fillwidth artworks={artworks} useRelay={false} />\n    })\n    return html\n  }\n\n  /**\n   * Sharify automatically passes over data to the client. Once render is called\n   * on the server append block and wait for client-side mount, which will then\n   * deserialize and rehydrate.\n   */\n  addToQueue(block) {\n    try {\n      this.res.locals.sharify.data.reactionBlocks.push(block)\n    } catch (error) {\n      console.error(\n        '(middlware/renderArtworkBrick) Error adding to queue:',\n        error\n      )\n    }\n  }\n\n  serialize() {\n    this.addToQueue({\n      mode: this.mode,\n      id: this.id,\n      type: this.type,\n      props: this.props,\n    })\n  }\n\n  deserialize(block) {\n    this.mode = 'client'\n    this.id = block.id\n    this.type = block.type\n    this.props = block.props\n\n    const blockType = this[this.type].bind(this)\n\n    if (isFunction(blockType)) {\n      blockType(this.props)\n    }\n  }\n\n  render(blockType) {\n    try {\n      const isServer = this.mode === 'server'\n\n      if (isServer) {\n        this.id = uniqueId('react-mount-reaction-')\n        const sheet = new ServerStyleSheet()\n        const html = renderToString(sheet.collectStyles(blockType(this.props)))\n        const css = sheet.getStyleTags()\n\n        this.serialize()\n\n        const out = [`<div id=${this.id}></div>`, css, html].join('\\n')\n        return out\n\n        // Client-side\n      } else {\n        ReactDOM.hydrate(\n          blockType(this.props),\n          document.getElementById(this.id)\n        )\n      }\n    } catch (error) {\n      console.error(\n        '(middleware/renderArtworkBrick) Error rendering server-side: ',\n        error\n      )\n    }\n  }\n}\n\nmodule.exports.serverRenderer = (req, res, next) => {\n  const renderer = new ReactionRenderer('server', res)\n  res.locals.reaction = renderer\n  res.locals.sharify.data.reactionBlocks = []\n  next()\n}\n\n// Fixtures: FIXME: (move)\n\nconst artwork = {\n  id: 'mikael-olson-some-kind-of-dinosaur',\n  title: 'Some Kind of Dinosaur',\n  date: '2015',\n  sale_message: '$875',\n  is_in_auction: false,\n  image: {\n    placeholder: 200,\n    // only required prop\n    url:\n      'https://d32dm0rphc51dk.cloudfront.net/w6h1rYqIqhhCRE5f0_fxMQ/larger.jpg',\n    aspect_ratio: 0.74,\n  },\n  artists: [\n    {\n      __id: 'mikael-olson',\n      name: 'Mikael Olson',\n    },\n  ],\n  partner: {\n    name: 'Gallery 1261',\n  },\n  href: '/artwork/mikael-olson-some-kind-of-dinosaur',\n}\n\nconst artworks = {\n  edges: [\n    {\n      node: {\n        __id: 'QXJ0d29yazpiYW5rc3ktd2UtbG92ZS15b3Utc28tbG92ZS11cw==',\n        image: {\n          aspect_ratio: 1,\n          placeholder: '100%',\n          url:\n            'https://d32dm0rphc51dk.cloudfront.net/hoFocUdpgF4mazPIgekpZA/large.jpg',\n        },\n        href: '/artwork/banksy-we-love-you-so-love-us',\n        title: 'We Love You So Love Us',\n        date: '2000',\n        sale_message: 'Contact For Price',\n        cultural_maker: null,\n        artists: [\n          {\n            __id: 'QXJ0aXN0OmJhbmtzeQ==',\n            href: '/artist/banksy',\n            name: 'Banksy',\n          },\n        ],\n        collecting_institution: null,\n        partner: {\n          name: 'EHC Fine Art',\n          href: '/ehc-fine-art',\n          __id: 'UGFydG5lcjplaGMtZmluZS1hcnQ=',\n          type: 'Gallery',\n        },\n        sale: null,\n        _id: '58e1a19d275b247d353ff0d9',\n        is_inquireable: true,\n        sale_artwork: null,\n        id: 'banksy-we-love-you-so-love-us',\n        is_saved: null,\n      },\n    },\n    {\n      node: {\n        __id: 'QXJ0d29yazpiYW5rc3ktcmFkYXItcmF0LWRpcnR5LWZ1bmtlci1scA==',\n        image: {\n          aspect_ratio: 1,\n          placeholder: '100%',\n          url:\n            'https://d32dm0rphc51dk.cloudfront.net/NQvnb87U8oGDm6kpdJ9jLA/large.jpg',\n        },\n        href: '/artwork/banksy-radar-rat-dirty-funker-lp',\n        title: 'Radar Rat (Dirty Funker LP)',\n        date: '2008',\n        sale_message: '$950',\n        cultural_maker: null,\n        artists: [\n          {\n            __id: 'QXJ0aXN0OmJhbmtzeQ==',\n            href: '/artist/banksy',\n            name: 'Banksy',\n          },\n        ],\n        collecting_institution: null,\n        partner: {\n          name: 'EHC Fine Art',\n          href: '/ehc-fine-art',\n          __id: 'UGFydG5lcjplaGMtZmluZS1hcnQ=',\n          type: 'Gallery',\n        },\n        sale: null,\n        _id: '58e1a19ecd530e4d612cb07f',\n        is_inquireable: true,\n        sale_artwork: null,\n        id: 'banksy-radar-rat-dirty-funker-lp',\n        is_saved: null,\n      },\n    },\n    {\n      node: {\n        __id: 'QXJ0d29yazpiYW5rc3ktZmxvd2VyLWJvbWJlci1ieS1icmFuZGFsaXNt',\n        image: {\n          aspect_ratio: 1.5,\n          placeholder: '66.66666666666666%',\n          url:\n            'https://d32dm0rphc51dk.cloudfront.net/88LaQZxzQdksn76f0LGFoQ/large.jpg',\n        },\n        href: '/artwork/banksy-flower-bomber-by-brandalism',\n        title: 'Flower Bomber (by Brandalism)',\n        date: 'ca. 2017',\n        sale_message: 'Contact For Price',\n        cultural_maker: null,\n        artists: [\n          {\n            __id: 'QXJ0aXN0OmJhbmtzeQ==',\n            href: '/artist/banksy',\n            name: 'Banksy',\n          },\n        ],\n        collecting_institution: null,\n        partner: {\n          name: 'EHC Fine Art',\n          href: '/ehc-fine-art',\n          __id: 'UGFydG5lcjplaGMtZmluZS1hcnQ=',\n          type: 'Gallery',\n        },\n        sale: null,\n        _id: '58e1a19f275b247d353ff0e2',\n        is_inquireable: true,\n        sale_artwork: null,\n        id: 'banksy-flower-bomber-by-brandalism',\n        is_saved: null,\n      },\n    },\n    {\n      node: {\n        __id: 'QXJ0d29yazpiYW5rc3ktZ2lybC13aXRoLWJhbGxvb24tMTQ=',\n        image: {\n          aspect_ratio: 0.75,\n          placeholder: '132.9%',\n          url:\n            'https://d32dm0rphc51dk.cloudfront.net/RRGE9Ild18_IPghZXT6wuQ/large.jpg',\n        },\n        href: '/artwork/banksy-girl-with-balloon-14',\n        title: 'Girl With Balloon',\n        date: '2004',\n        sale_message: 'Contact For Price',\n        cultural_maker: null,\n        artists: [\n          {\n            __id: 'QXJ0aXN0OmJhbmtzeQ==',\n            href: '/artist/banksy',\n            name: 'Banksy',\n          },\n        ],\n        collecting_institution: null,\n        partner: {\n          name: 'Graffik Gallery / Banksy Editions',\n          href: '/graffik-gallery-slash-banksy-editions',\n          __id: 'UGFydG5lcjpncmFmZmlrLWdhbGxlcnktc2xhc2gtYmFua3N5LWVkaXRpb25z',\n          type: 'Gallery',\n        },\n        sale: null,\n        _id: '58e370659c18db774f25ed5b',\n        is_inquireable: true,\n        sale_artwork: null,\n        id: 'banksy-girl-with-balloon-14',\n        is_saved: null,\n      },\n    },\n  ],\n}\n"]}]}