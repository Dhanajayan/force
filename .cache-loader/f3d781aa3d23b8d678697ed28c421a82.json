{"remainingRequest":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js??ref--2-1!/Users/eve/development/force/src/lib/volley.js","dependencies":[{"path":"/Users/eve/development/force/src/lib/volley.js","mtime":1530028054000},{"path":"/Users/eve/development/force/.babelrc","mtime":1528124541000},{"path":"/Users/eve/development/force/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js","mtime":1509489566000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.reportLoadTimeToVolley = reportLoadTimeToVolley;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _sharify = require(\"sharify\");\n\nvar _superagent = _interopRequireDefault(require(\"superagent\"));\n\nfunction metricPayload(pageType, deviceType, name, start, end) {\n  return start > 0 && end > 0 && end - start > 0 ? {\n    type: 'timing',\n    name: 'load-time',\n    timing: end - start,\n    tags: [\"page-type:\".concat(pageType), \"device-type:\".concat(deviceType), \"mark:\".concat(name)]\n  } : null;\n}\n\nfunction reportLoadTimeToVolley(_x, _x2, _x3, _x4, _x5) {\n  return _reportLoadTimeToVolley.apply(this, arguments);\n}\n\nfunction _reportLoadTimeToVolley() {\n  _reportLoadTimeToVolley = (0, _asyncToGenerator2.default)(\n  /*#__PURE__*/\n  _regenerator.default.mark(function _callee(requestStart, loadEventEnd, domComplete, pageType, deviceType) {\n    var metrics;\n    return _regenerator.default.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!_sharify.data.VOLLEY_ENDPOINT) {\n              _context.next = 6;\n              break;\n            }\n\n            metrics = [metricPayload(pageType, deviceType, 'dom-complete', requestStart, domComplete), metricPayload(pageType, deviceType, 'load-event-end', requestStart, loadEventEnd)].filter(function (metric) {\n              return metric != null;\n            });\n\n            if (!(metrics.length > 0)) {\n              _context.next = 6;\n              break;\n            }\n\n            _context.next = 5;\n            return _superagent.default.post(_sharify.data.VOLLEY_ENDPOINT).send({\n              serviceName: 'force',\n              metrics: metrics\n            });\n\n          case 5:\n            return _context.abrupt(\"return\", _context.sent);\n\n          case 6:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, this);\n  }));\n  return _reportLoadTimeToVolley.apply(this, arguments);\n}",{"version":3,"sources":["src/lib/volley.js"],"names":["metricPayload","pageType","deviceType","name","start","end","type","timing","tags","reportLoadTimeToVolley","requestStart","loadEventEnd","domComplete","VOLLEY_ENDPOINT","metrics","filter","metric","length","post","send","serviceName"],"mappings":";;;;;;;;;;;;;AAAA;;AACA;;AAEA,SAASA,aAAT,CAAuBC,QAAvB,EAAiCC,UAAjC,EAA6CC,IAA7C,EAAmDC,KAAnD,EAA0DC,GAA1D,EAA+D;AAC7D,SAAOD,QAAQ,CAAR,IAAaC,MAAM,CAAnB,IAAwBA,MAAMD,KAAN,GAAc,CAAtC,GACH;AACEE,UAAM,QADR;AAEEH,UAAM,WAFR;AAGEI,YAAQF,MAAMD,KAHhB;AAIEI,UAAM,qBACSP,QADT,yBAEWC,UAFX,kBAGIC,IAHJ;AAJR,GADG,GAWH,IAXJ;AAYD;;SAEqBM,sB;;;;;;;4BAAf,iBACLC,YADK,EAELC,YAFK,EAGLC,WAHK,EAILX,QAJK,EAKLC,UALK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAOD,cAAGW,eAPF;AAAA;AAAA;AAAA;;AAQGC,mBARH,GAQa,CACdd,cACEC,QADF,EAEEC,UAFF,EAGE,cAHF,EAIEQ,YAJF,EAKEE,WALF,CADc,EAQdZ,cACEC,QADF,EAEEC,UAFF,EAGE,gBAHF,EAIEQ,YAJF,EAKEC,YALF,CARc,EAedI,MAfc,CAeP;AAAA,qBAAUC,UAAU,IAApB;AAAA,aAfO,CARb;;AAAA,kBAyBCF,QAAQG,MAAR,GAAiB,CAzBlB;AAAA;AAAA;AAAA;;AAAA;AAAA,mBA0BY,oBAAQC,IAAR,CAAa,cAAGL,eAAhB,EAAiCM,IAAjC,CAAsC;AACjDC,2BAAa,OADoC;AAEjDN;AAFiD,aAAtC,CA1BZ;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","file":"/Users/eve/development/force/src/lib/volley.js","sourceRoot":"/Users/eve/development/force","sourcesContent":["import { data as sd } from 'sharify'\nimport request from 'superagent'\n\nfunction metricPayload(pageType, deviceType, name, start, end) {\n  return start > 0 && end > 0 && end - start > 0\n    ? {\n        type: 'timing',\n        name: 'load-time',\n        timing: end - start,\n        tags: [\n          `page-type:${pageType}`,\n          `device-type:${deviceType}`,\n          `mark:${name}`,\n        ],\n      }\n    : null\n}\n\nexport async function reportLoadTimeToVolley(\n  requestStart,\n  loadEventEnd,\n  domComplete,\n  pageType,\n  deviceType\n) {\n  if (sd.VOLLEY_ENDPOINT) {\n    const metrics = [\n      metricPayload(\n        pageType,\n        deviceType,\n        'dom-complete',\n        requestStart,\n        domComplete\n      ),\n      metricPayload(\n        pageType,\n        deviceType,\n        'load-event-end',\n        requestStart,\n        loadEventEnd\n      ),\n    ].filter(metric => metric != null)\n\n    if (metrics.length > 0) {\n      return await request.post(sd.VOLLEY_ENDPOINT).send({\n        serviceName: 'force',\n        metrics,\n      })\n    }\n  }\n}\n"]}]}