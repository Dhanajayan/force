{"remainingRequest":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js??ref--2-1!/Users/eve/development/force/node_modules/@artsy/reaction/src/Utils/metaphysics.ts","dependencies":[{"path":"/Users/eve/development/force/node_modules/@artsy/reaction/src/Utils/metaphysics.ts","mtime":1528820562000},{"path":"/Users/eve/development/force/node_modules/@artsy/reaction/.babelrc","mtime":1529423546000},{"path":"/Users/eve/development/force/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js","mtime":1509489566000}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.metaphysics = metaphysics;\nexports.query = query;\n\nrequire(\"isomorphic-fetch\");\n\nvar sharify = _interopRequireWildcard(require(\"sharify\"));\n\nvar _errors = require(\"./errors\");\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction metaphysics(payload, user) {\n  var checkStatus = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  var headers = {\n    \"Content-Type\": \"application/json\",\n    \"User-Agent\": \"Reaction\" // TODO: rename User to AuthTokens and conver to union type\n\n  };\n  var AuthHeaders = !!user ? !!user.appToken ? {\n    \"X-XAPP-TOKEN\": user.appToken\n  } : {\n    \"X-USER-ID\": user.id,\n    \"X-ACCESS-TOKEN\": user.accessToken\n  } : null;\n  return fetch(sharify.data.METAPHYSICS_ENDPOINT, {\n    method: \"POST\",\n    headers: !!user ? _extends({}, headers, AuthHeaders) : headers,\n    body: JSON.stringify(payload)\n  }).then(function (response) {\n    if (!checkStatus || response.status >= 200 && response.status < 300) {\n      return response;\n    } else {\n      var error = new _errors.NetworkError(response.statusText);\n      error.response = response;\n      throw error;\n    }\n  }).then(function (response) {\n    return response.json();\n  });\n}\n\nfunction query(query) {\n  return metaphysics({\n    query: query\n  }).then(function (_ref) {\n    var data = _ref.data;\n    return data;\n  });\n}",{"version":3,"sources":["node_modules/@artsy/reaction/src/Utils/metaphysics.ts"],"names":["metaphysics","payload","user","checkStatus","headers","AuthHeaders","appToken","id","accessToken","fetch","sharify","data","METAPHYSICS_ENDPOINT","method","body","JSON","stringify","then","response","status","error","statusText","json","query"],"mappings":";;;;;;;;AAGA;;AACA;;AACA;;;;;;AAEO,SAASA,WAAT,CACLC,OADK,EAELC,IAFK,EAIO;AAAA,MADZC,WACY,uEADW,IACX;AACZ,MAAMC,UAAU;AACd,oBAAgB,kBADF;AAEd,kBAAc,UAFA,CAKhB;;AALgB,GAAhB;AAMA,MAAMC,cAAc,CAAC,CAACH,IAAF,GAChB,CAAC,CAACA,KAAKI,QAAP,GACE;AAAE,oBAAgBJ,KAAKI;AAAvB,GADF,GAEE;AACE,iBAAaJ,KAAKK,EADpB;AAEE,sBAAkBL,KAAKM;AAFzB,GAHc,GAOhB,IAPJ;AASA,SAAOC,MAAMC,QAAQC,IAAR,CAAaC,oBAAnB,EAAyC;AAC9CC,YAAQ,MADsC;AAE9CT,aAAS,CAAC,CAACF,IAAF,gBAEAE,OAFA,EAGAC,WAHA,IAKLD,OAP0C;AAQ9CU,UAAMC,KAAKC,SAAL,CAAef,OAAf;AARwC,GAAzC,EAUJgB,IAVI,CAUC,oBAAY;AAChB,QAAI,CAACd,WAAD,IAAiBe,SAASC,MAAT,IAAmB,GAAnB,IAA0BD,SAASC,MAAT,GAAkB,GAAjE,EAAuE;AACrE,aAAOD,QAAP;AACD,KAFD,MAEO;AACL,UAAME,QAAQ,yBAAiBF,SAASG,UAA1B,CAAd;AACAD,YAAMF,QAAN,GAAiBA,QAAjB;AACA,YAAME,KAAN;AACD;AACF,GAlBI,EAmBJH,IAnBI,CAmBI;AAAA,WAAYC,SAASI,IAAT,EAAZ;AAAA,GAnBJ,CAAP;AAoBD;;AAEM,SAASC,KAAT,CAAkBA,KAAlB,EAA6C;AAClD,SAAOvB,YAAyB;AAAEuB;AAAF,GAAzB,EAAoCN,IAApC,CAAyC;AAAA,QAAGN,IAAH,QAAGA,IAAH;AAAA,WAAcA,IAAd;AAAA,GAAzC,CAAP;AACD","file":"/Users/eve/development/force/node_modules/@artsy/reaction/src/Utils/metaphysics.ts","sourceRoot":"/Users/eve/development/force","sourcesContent":["// TODO: Deprecated in favor of react-relay-network-modern, need to remove.\n// See `Relay/createEnvironment` for new implementation.\n\nimport \"isomorphic-fetch\"\nimport * as sharify from \"sharify\"\nimport { NetworkError } from \"./errors\"\n\nexport function metaphysics<T>(\n  payload: { query: string; variables?: object },\n  user?: User,\n  checkStatus: boolean = true\n): Promise<T> {\n  const headers = {\n    \"Content-Type\": \"application/json\",\n    \"User-Agent\": \"Reaction\",\n  }\n\n  // TODO: rename User to AuthTokens and conver to union type\n  const AuthHeaders = !!user\n    ? !!user.appToken\n      ? { \"X-XAPP-TOKEN\": user.appToken }\n      : {\n          \"X-USER-ID\": user.id,\n          \"X-ACCESS-TOKEN\": user.accessToken,\n        }\n    : null\n\n  return fetch(sharify.data.METAPHYSICS_ENDPOINT, {\n    method: \"POST\",\n    headers: !!user\n      ? {\n          ...headers,\n          ...AuthHeaders,\n        }\n      : headers,\n    body: JSON.stringify(payload),\n  })\n    .then(response => {\n      if (!checkStatus || (response.status >= 200 && response.status < 300)) {\n        return response\n      } else {\n        const error = new NetworkError(response.statusText)\n        error.response = response\n        throw error\n      }\n    })\n    .then<T>(response => response.json())\n}\n\nexport function query<T>(query: string): Promise<T> {\n  return metaphysics<{ data: T }>({ query }).then(({ data }) => data)\n}\n"]}]}