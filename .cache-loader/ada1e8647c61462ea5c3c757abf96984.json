{"remainingRequest":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js??ref--2-1!/Users/eve/development/force/src/desktop/apps/article/components/layouts/Article.js","dependencies":[{"path":"/Users/eve/development/force/src/desktop/apps/article/components/layouts/Article.js","mtime":1537268478000},{"path":"/Users/eve/development/force/.babelrc","mtime":1537178749000},{"path":"/Users/eve/development/force/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"@babel/runtime/helpers/objectSpread\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _once from \"lodash/once\";\n\n(function () {\n  var enterModule = require('react-hot-loader').enterModule;\n\n  enterModule && enterModule(module);\n})();\n\nimport ArticleModel from \"../../../../models/article.coffee\";\nimport InfiniteScrollArticle from \"../InfiniteScrollArticle\";\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { Article } from \"@artsy/reaction/dist/Components/Publishing\";\nimport Cookies from \"../../../../components/cookies/index.coffee\";\nimport _SuperArticleView from \"../../../../components/article/client/super_article.coffee\";\nimport { setupFollows, setupFollowButtons } from \"../FollowButton.js\";\nimport mediator from \"../../../../lib/mediator.coffee\"; // FIXME: Rewire\n\nvar SuperArticleView = _SuperArticleView;\n\nvar ArticleLayout =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ArticleLayout, _React$Component);\n\n  function ArticleLayout(props) {\n    var _this;\n\n    _classCallCheck(this, ArticleLayout);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ArticleLayout).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"handleOpenAuthModal\", function (mode, options) {\n      mediator.trigger('open:auth', _objectSpread({\n        mode: mode\n      }, options));\n    });\n\n    _this.state = {\n      following: setupFollows() || null\n    };\n    return _this;\n  }\n\n  _createClass(ArticleLayout, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$props = this.props,\n          article = _this$props.article,\n          isSuper = _this$props.isSuper; // TODO: Replace with relay follow\n\n      setupFollowButtons(this.state.following);\n\n      if (isSuper) {\n        new SuperArticleView({\n          el: document.querySelector('body'),\n          article: new ArticleModel(article)\n        });\n      }\n\n      var editorialAuthDismissedCookie = Cookies.get('editorial-signup-dismissed');\n\n      if (!this.props.isLoggedIn && !editorialAuthDismissedCookie) {\n        this.showAuthModal();\n      } // setup listener for dismissal cookie\n\n\n      mediator.on('modal:closed', this.dismissAuthModal);\n    }\n  }, {\n    key: \"dismissAuthModal\",\n    value: function dismissAuthModal() {\n      Cookies.set('editorial-signup-dismissed', 1, {\n        expires: 864000\n      });\n    }\n  }, {\n    key: \"showAuthModal\",\n    value: function showAuthModal() {\n      var _this2 = this;\n\n      if (!this.props.isLoggedIn && !this.props.isMobile) {\n        window.addEventListener('scroll', _once(function () {\n          setTimeout(function () {\n            _this2.handleOpenAuthModal('register', {\n              mode: 'signup',\n              intent: 'Viewed editorial',\n              signupIntent: 'signup',\n              trigger: 'timed',\n              triggerSeconds: 2,\n              copy: 'Sign up for the Best Stories in Art and Visual Culture',\n              destination: location.href\n            });\n          }, 2000);\n        }), {\n          once: true\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          article = _this$props2.article,\n          isSuper = _this$props2.isSuper,\n          isLoggedIn = _this$props2.isLoggedIn,\n          isMobile = _this$props2.isMobile,\n          renderTime = _this$props2.renderTime,\n          showTooltips = _this$props2.showTooltips,\n          _this$props2$template = _this$props2.templates;\n      _this$props2$template = _this$props2$template === void 0 ? {} : _this$props2$template;\n      var SuperArticleFooter = _this$props2$template.SuperArticleFooter,\n          SuperArticleHeader = _this$props2$template.SuperArticleHeader;\n      var hasNav = isSuper || article.seriesArticle;\n      var isStatic = hasNav;\n      return React.createElement(\"div\", null, isSuper && React.createElement(\"div\", {\n        dangerouslySetInnerHTML: {\n          __html: SuperArticleHeader\n        }\n      }), isStatic ? React.createElement(Article, {\n        article: article,\n        display: article.display,\n        isMobile: isMobile,\n        isLoggedIn: isLoggedIn,\n        onOpenAuthModal: this.handleOpenAuthModal,\n        relatedArticlesForPanel: article.relatedArticlesPanel,\n        relatedArticlesForCanvas: article.relatedArticlesCanvas,\n        renderTime: renderTime,\n        showTooltips: showTooltips\n      }) : React.createElement(InfiniteScrollArticle, {\n        article: article,\n        isMobile: isMobile,\n        onOpenAuthModal: this.handleOpenAuthModal,\n        renderTime: renderTime,\n        showTooltips: showTooltips\n      }), isSuper && React.createElement(\"div\", {\n        dangerouslySetInnerHTML: {\n          __html: SuperArticleFooter\n        }\n      }));\n    }\n  }, {\n    key: \"__reactstandin__regenerateByEval\",\n    value: function __reactstandin__regenerateByEval(key, code) {\n      this[key] = eval(code);\n    }\n  }]);\n\n  return ArticleLayout;\n}(React.Component);\n\n_defineProperty(ArticleLayout, \"propTypes\", {\n  article: PropTypes.object,\n  isMobile: PropTypes.bool,\n  isLoggedIn: PropTypes.bool,\n  isSuper: PropTypes.bool,\n  templates: PropTypes.object,\n  showTooltips: PropTypes.bool,\n  renderTime: PropTypes.number\n});\n\nexport { ArticleLayout as default };\n;\n\n(function () {\n  var reactHotLoader = require('react-hot-loader').default;\n\n  var leaveModule = require('react-hot-loader').leaveModule;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(SuperArticleView, \"SuperArticleView\", \"/Users/eve/development/force/src/desktop/apps/article/components/layouts/Article.js\");\n  reactHotLoader.register(ArticleLayout, \"ArticleLayout\", \"/Users/eve/development/force/src/desktop/apps/article/components/layouts/Article.js\");\n  leaveModule(module);\n})();\n\n;",{"version":3,"sources":["/Users/eve/development/force/src/desktop/apps/article/components/layouts/Article.js"],"names":["ArticleModel","InfiniteScrollArticle","PropTypes","React","Article","Cookies","_SuperArticleView","setupFollows","setupFollowButtons","mediator","SuperArticleView","ArticleLayout","props","mode","options","trigger","state","following","article","isSuper","el","document","querySelector","editorialAuthDismissedCookie","get","isLoggedIn","showAuthModal","on","dismissAuthModal","set","expires","isMobile","window","addEventListener","setTimeout","handleOpenAuthModal","intent","signupIntent","triggerSeconds","copy","destination","location","href","once","renderTime","showTooltips","templates","SuperArticleFooter","SuperArticleHeader","hasNav","seriesArticle","isStatic","__html","display","relatedArticlesPanel","relatedArticlesCanvas","Component","object","bool","number"],"mappings":"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","sourcesContent":["import ArticleModel from 'desktop/models/article.coffee'\nimport InfiniteScrollArticle from '../InfiniteScrollArticle'\nimport { once } from 'lodash'\nimport PropTypes from 'prop-types'\nimport React from 'react'\nimport { Article } from 'reaction/Components/Publishing'\nimport Cookies from 'desktop/components/cookies/index.coffee'\nimport _SuperArticleView from 'desktop/components/article/client/super_article.coffee'\nimport { setupFollows, setupFollowButtons } from '../FollowButton.js'\nimport mediator from 'desktop/lib/mediator.coffee'\n\n// FIXME: Rewire\nlet SuperArticleView = _SuperArticleView\n\nexport default class ArticleLayout extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      following: setupFollows() || null,\n    }\n  }\n  static propTypes = {\n    article: PropTypes.object,\n    isMobile: PropTypes.bool,\n    isLoggedIn: PropTypes.bool,\n    isSuper: PropTypes.bool,\n    templates: PropTypes.object,\n    showTooltips: PropTypes.bool,\n    renderTime: PropTypes.number,\n  }\n\n  componentDidMount() {\n    const { article, isSuper } = this.props\n    // TODO: Replace with relay follow\n    setupFollowButtons(this.state.following)\n\n    if (isSuper) {\n      new SuperArticleView({\n        el: document.querySelector('body'),\n        article: new ArticleModel(article),\n      })\n    }\n\n    const editorialAuthDismissedCookie = Cookies.get(\n      'editorial-signup-dismissed'\n    )\n\n    if (!this.props.isLoggedIn && !editorialAuthDismissedCookie) {\n      this.showAuthModal()\n    }\n\n    // setup listener for dismissal cookie\n    mediator.on('modal:closed', this.dismissAuthModal)\n  }\n\n  dismissAuthModal() {\n    Cookies.set('editorial-signup-dismissed', 1, { expires: 864000 })\n  }\n\n  showAuthModal() {\n    if (!this.props.isLoggedIn && !this.props.isMobile) {\n      window.addEventListener(\n        'scroll',\n        once(() => {\n          setTimeout(() => {\n            this.handleOpenAuthModal('register', {\n              mode: 'signup',\n              intent: 'Viewed editorial',\n              signupIntent: 'signup',\n              trigger: 'timed',\n              triggerSeconds: 2,\n              copy: 'Sign up for the Best Stories in Art and Visual Culture',\n              destination: location.href,\n            })\n          }, 2000)\n        }),\n        { once: true }\n      )\n    }\n  }\n\n  handleOpenAuthModal = (mode, options) => {\n    mediator.trigger('open:auth', {\n      mode,\n      ...options,\n    })\n  }\n\n  render() {\n    const {\n      article,\n      isSuper,\n      isLoggedIn,\n      isMobile,\n      renderTime,\n      showTooltips,\n      templates: { SuperArticleFooter, SuperArticleHeader } = {},\n    } = this.props\n    const hasNav = isSuper || article.seriesArticle\n    const isStatic = hasNav\n\n    return (\n      <div>\n        {isSuper && (\n          <div\n            dangerouslySetInnerHTML={{\n              __html: SuperArticleHeader,\n            }}\n          />\n        )}\n\n        {isStatic ? (\n          <Article\n            article={article}\n            display={article.display}\n            isMobile={isMobile}\n            isLoggedIn={isLoggedIn}\n            onOpenAuthModal={this.handleOpenAuthModal}\n            relatedArticlesForPanel={article.relatedArticlesPanel}\n            relatedArticlesForCanvas={article.relatedArticlesCanvas}\n            renderTime={renderTime}\n            showTooltips={showTooltips}\n          />\n        ) : (\n          <InfiniteScrollArticle\n            article={article}\n            isMobile={isMobile}\n            onOpenAuthModal={this.handleOpenAuthModal}\n            renderTime={renderTime}\n            showTooltips={showTooltips}\n          />\n        )}\n\n        {isSuper && (\n          <div\n            dangerouslySetInnerHTML={{\n              __html: SuperArticleFooter,\n            }}\n          />\n        )}\n      </div>\n    )\n  }\n}\n"]}]}