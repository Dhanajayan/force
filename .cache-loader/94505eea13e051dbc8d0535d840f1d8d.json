{"remainingRequest":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js??ref--2-1!/Users/eve/development/force/src/desktop/analytics/impressions.js","dependencies":[{"path":"/Users/eve/development/force/src/desktop/analytics/impressions.js","mtime":1519227435000},{"path":"/Users/eve/development/force/.babelrc","mtime":1528124541000},{"path":"/Users/eve/development/force/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js","mtime":1509489566000}],"contextDependencies":[],"result":["var trackedIds = [];\n\nvar visibleArtworkIds = function visibleArtworkIds() {\n  // Find all of the \"artwork item\" components that are visible\n  // Extra verbose for clarity's sake\n  var ids = $('.artwork-item').filter(function () {\n    var viewportTop = $(window).scrollTop();\n    var viewportBottom = viewportTop + $(window).height();\n    var artworkTop = $(this).offset().top;\n    var artworkBottom = artworkTop + $(this).outerHeight(); // Either artwork top or artwork bottom is below the top\n    // of the browser and above the fold.\n\n    var topInView = artworkTop > viewportTop && artworkTop < viewportBottom;\n    var bottomInView = artworkBottom > viewportTop && artworkBottom < viewportBottom;\n    return topInView || bottomInView;\n  }).map(function () {\n    return $(this).attr('data-id');\n  }).toArray(); // Add the artwork page as an impression\n\n  if ($('#artwork-page').length && sd.ARTWORK) ids.push(sd.ARTWORK._id); // Don't double track the same impressions\n\n  ids = _.difference(ids, trackedIds);\n  trackedIds = trackedIds.concat(ids); // Return only the new impressions\n\n  return ids.join();\n};\n\nvar trackImpressions = function trackImpressions() {\n  var ids = visibleArtworkIds();\n\n  if (ids.length > 0) {\n    analytics.track('Artwork impressions', {\n      ids: ids,\n      nonInteraction: 1\n    });\n  }\n};\n\ntrackImpressions();\n$(window).on('scroll', _.throttle(trackImpressions, 200));",{"version":3,"sources":["src/desktop/analytics/impressions.js"],"names":["trackedIds","visibleArtworkIds","ids","$","filter","viewportTop","window","scrollTop","viewportBottom","height","artworkTop","offset","top","artworkBottom","outerHeight","topInView","bottomInView","map","attr","toArray","length","sd","ARTWORK","push","_id","_","difference","concat","join","trackImpressions","analytics","track","nonInteraction","on","throttle"],"mappings":"AAAA,IAAIA,aAAa,EAAjB;;AAEA,IAAIC,oBAAoB,SAApBA,iBAAoB,GAAY;AAClC;AACA;AACA,MAAIC,MAAMC,EAAE,eAAF,EAAmBC,MAAnB,CAA0B,YAAY;AAC9C,QAAIC,cAAcF,EAAEG,MAAF,EAAUC,SAAV,EAAlB;AACA,QAAIC,iBAAiBH,cAAcF,EAAEG,MAAF,EAAUG,MAAV,EAAnC;AACA,QAAIC,aAAaP,EAAE,IAAF,EAAQQ,MAAR,GAAiBC,GAAlC;AACA,QAAIC,gBAAgBH,aAAaP,EAAE,IAAF,EAAQW,WAAR,EAAjC,CAJ8C,CAM9C;AACA;;AACA,QAAIC,YAAYL,aAAaL,WAAb,IAA4BK,aAAaF,cAAzD;AACA,QAAIQ,eAAeH,gBAAgBR,WAAhB,IAA+BQ,gBAAgBL,cAAlE;AAEA,WAAOO,aAAaC,YAApB;AACD,GAZS,EAYPC,GAZO,CAYH,YAAY;AACjB,WAAOd,EAAE,IAAF,EAAQe,IAAR,CAAa,SAAb,CAAP;AACD,GAdS,EAcPC,OAdO,EAAV,CAHkC,CAmBlC;;AACA,MAAIhB,EAAE,eAAF,EAAmBiB,MAAnB,IAA6BC,GAAGC,OAApC,EAA6CpB,IAAIqB,IAAJ,CAASF,GAAGC,OAAH,CAAWE,GAApB,EApBX,CAsBlC;;AACAtB,QAAMuB,EAAEC,UAAF,CAAaxB,GAAb,EAAkBF,UAAlB,CAAN;AACAA,eAAaA,WAAW2B,MAAX,CAAkBzB,GAAlB,CAAb,CAxBkC,CA0BlC;;AACA,SAAOA,IAAI0B,IAAJ,EAAP;AACD,CA5BD;;AA8BA,IAAIC,mBAAmB,SAAnBA,gBAAmB,GAAY;AACjC,MAAI3B,MAAMD,mBAAV;;AACA,MAAIC,IAAIkB,MAAJ,GAAa,CAAjB,EAAoB;AAClBU,cAAUC,KAAV,CAAgB,qBAAhB,EAAuC;AACrC7B,WAAKA,GADgC;AAC3B8B,sBAAgB;AADW,KAAvC;AAGD;AACF,CAPD;;AASAH;AACA1B,EAAEG,MAAF,EAAU2B,EAAV,CAAa,QAAb,EAAuBR,EAAES,QAAF,CAAWL,gBAAX,EAA6B,GAA7B,CAAvB","file":"/Users/eve/development/force/src/desktop/analytics/impressions.js","sourceRoot":"/Users/eve/development/force","sourcesContent":["var trackedIds = []\n\nvar visibleArtworkIds = function () {\n  // Find all of the \"artwork item\" components that are visible\n  // Extra verbose for clarity's sake\n  var ids = $('.artwork-item').filter(function () {\n    var viewportTop = $(window).scrollTop()\n    var viewportBottom = viewportTop + $(window).height()\n    var artworkTop = $(this).offset().top\n    var artworkBottom = artworkTop + $(this).outerHeight()\n\n    // Either artwork top or artwork bottom is below the top\n    // of the browser and above the fold.\n    var topInView = artworkTop > viewportTop && artworkTop < viewportBottom\n    var bottomInView = artworkBottom > viewportTop && artworkBottom < viewportBottom\n\n    return topInView || bottomInView\n  }).map(function () {\n    return $(this).attr('data-id')\n  }).toArray()\n\n  // Add the artwork page as an impression\n  if ($('#artwork-page').length && sd.ARTWORK) ids.push(sd.ARTWORK._id)\n\n  // Don't double track the same impressions\n  ids = _.difference(ids, trackedIds)\n  trackedIds = trackedIds.concat(ids)\n\n  // Return only the new impressions\n  return ids.join()\n}\n\nvar trackImpressions = function () {\n  var ids = visibleArtworkIds()\n  if (ids.length > 0) {\n    analytics.track('Artwork impressions', {\n      ids: ids, nonInteraction: 1\n    })\n  }\n}\n\ntrackImpressions()\n$(window).on('scroll', _.throttle(trackImpressions, 200))\n"]}]}