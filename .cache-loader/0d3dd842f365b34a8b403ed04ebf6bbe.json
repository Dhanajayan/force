{"remainingRequest":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js??ref--2-1!/Users/eve/development/force/src/desktop/apps/article/components/EditButton.js","dependencies":[{"path":"/Users/eve/development/force/src/desktop/apps/article/components/EditButton.js","mtime":1522346108000},{"path":"/Users/eve/development/force/.babelrc","mtime":1528124541000},{"path":"/Users/eve/development/force/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js","mtime":1509489566000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.EditButton = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _getPrototypeOf = _interopRequireDefault(require(\"@babel/runtime/core-js/object/get-prototype-of\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _channelMember = _interopRequireDefault(require(\"../queries/channelMember\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _positronql2 = require(\"../../../lib/positronql\");\n\nvar _styledComponents = _interopRequireDefault(require(\"styled-components\"));\n\nvar _sharify = require(\"sharify\");\n\nvar _underscore = require(\"underscore\");\n\n// FIXME: Rewire\nvar sd = _sharify.data;\nvar positronql = _positronql2.positronql;\n\nvar EditButton =\n/*#__PURE__*/\nfunction (_React$Component) {\n  (0, _inherits2.default)(EditButton, _React$Component);\n\n  function EditButton() {\n    var _ref;\n\n    var _temp, _this;\n\n    (0, _classCallCheck2.default)(this, EditButton);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return (0, _possibleConstructorReturn2.default)(_this, (_temp = _this = (0, _possibleConstructorReturn2.default)(this, (_ref = EditButton.__proto__ || (0, _getPrototypeOf.default)(EditButton)).call.apply(_ref, [this].concat(args))), Object.defineProperty((0, _assertThisInitialized2.default)(_this), \"state\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: {\n        hasButtonState: false\n      }\n    }), Object.defineProperty((0, _assertThisInitialized2.default)(_this), \"componentDidMount\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: function () {\n        var _value = (0, _asyncToGenerator2.default)(\n        /*#__PURE__*/\n        _regenerator.default.mark(function _callee() {\n          var userId, data;\n          return _regenerator.default.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  userId = sd.CURRENT_USER && sd.CURRENT_USER.id;\n\n                  if (userId) {\n                    _context.next = 3;\n                    break;\n                  }\n\n                  return _context.abrupt(\"return\", _this.setState({\n                    showEditButton: false,\n                    hasButtonState: true\n                  }));\n\n                case 3:\n                  _context.next = 5;\n                  return positronql({\n                    query: (0, _channelMember.default)(userId)\n                  });\n\n                case 5:\n                  data = _context.sent;\n\n                  if ((0, _underscore.contains)((0, _underscore.pluck)(data.channels, 'id'), _this.props.channelId)) {\n                    _this.setState({\n                      showEditButton: true,\n                      hasButtonState: true\n                    });\n                  } else {\n                    _this.setState({\n                      showEditButton: false,\n                      hasButtonState: true\n                    });\n                  }\n\n                case 7:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, this);\n        }));\n\n        return function value() {\n          return _value.apply(this, arguments);\n        };\n      }()\n    }), _temp));\n  }\n\n  (0, _createClass2.default)(EditButton, [{\n    key: \"render\",\n    value: function render() {\n      var _state = this.state,\n          hasButtonState = _state.hasButtonState,\n          showEditButton = _state.showEditButton;\n      var _props = this.props,\n          positionTop = _props.positionTop,\n          slug = _props.slug;\n\n      if (!hasButtonState || !showEditButton) {\n        return false;\n      } else {\n        return React.createElement(StyledEditButton, {\n          target: \"_blank\",\n          href: \"\".concat(sd.POSITRON_URL, \"/articles/\").concat(slug, \"/edit\"),\n          positionTop: positionTop\n        }, React.createElement(\"i\", {\n          className: \"icon-with-black-circle icon-edit\"\n        }));\n      }\n    }\n  }]);\n  return EditButton;\n}(React.Component);\n\nexports.EditButton = EditButton;\nObject.defineProperty(EditButton, \"propTypes\", {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  value: {\n    channelId: _propTypes.default.string,\n    slug: _propTypes.default.string,\n    positionTop: _propTypes.default.number\n  }\n});\n\nvar StyledEditButton =\n/*#__PURE__*/\n_styledComponents.default.a.withConfig({\n  displayName: \"EditButton__StyledEditButton\",\n  componentId: \"s1oupfmt-0\"\n})([\"top:\", \";position:fixed;right:20px;\"], function (props) {\n  return props.positionTop ? \"\".concat(props.positionTop, \"px\") : \"75px\";\n});",{"version":3,"sources":["src/desktop/apps/article/components/EditButton.js"],"names":["sd","positronql","EditButton","hasButtonState","userId","CURRENT_USER","id","setState","showEditButton","query","data","channels","props","channelId","state","positionTop","slug","POSITRON_URL","React","Component","string","number","StyledEditButton","a"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA;AACA,IAAIA,kBAAJ;AACA,IAAIC,oCAAJ;;IAEaC,U;;;;;;;;;;;;;;;;;;;;aAOH;AACNC,wBAAgB;AADV;;;;;;;;kCAIY;AAAA;AAAA;AAAA;AAAA;AAAA;AACZC,wBADY,GACHJ,GAAGK,YAAH,IAAmBL,GAAGK,YAAH,CAAgBC,EADhC;;AAAA,sBAEbF,MAFa;AAAA;AAAA;AAAA;;AAAA,mDAGT,MAAKG,QAAL,CAAc;AAAEC,oCAAgB,KAAlB;AAAyBL,oCAAgB;AAAzC,mBAAd,CAHS;;AAAA;AAAA;AAAA,yBAKCF,WAAW;AAAEQ,2BAAO,4BAAmBL,MAAnB;AAAT,mBAAX,CALD;;AAAA;AAKZM,sBALY;;AAMlB,sBAAI,0BAAS,uBAAMA,KAAKC,QAAX,EAAqB,IAArB,CAAT,EAAqC,MAAKC,KAAL,CAAWC,SAAhD,CAAJ,EAAgE;AAC9D,0BAAKN,QAAL,CAAc;AAAEC,sCAAgB,IAAlB;AAAwBL,sCAAgB;AAAxC,qBAAd;AACD,mBAFD,MAEO;AACL,0BAAKI,QAAL,CAAc;AAAEC,sCAAgB,KAAlB;AAAyBL,sCAAgB;AAAzC,qBAAd;AACD;;AAViB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,S;;;;;;;;;;;6BAaX;AAAA,mBACoC,KAAKW,KADzC;AAAA,UACCX,cADD,UACCA,cADD;AAAA,UACiBK,cADjB,UACiBA,cADjB;AAAA,mBAEuB,KAAKI,KAF5B;AAAA,UAECG,WAFD,UAECA,WAFD;AAAA,UAEcC,IAFd,UAEcA,IAFd;;AAIP,UAAI,CAACb,cAAD,IAAmB,CAACK,cAAxB,EAAwC;AACtC,eAAO,KAAP;AACD,OAFD,MAEO;AACL,eACE,oBAAC,gBAAD;AACE,kBAAO,QADT;AAEE,0BAASR,GAAGiB,YAAZ,uBAAqCD,IAArC,UAFF;AAGE,uBAAaD;AAHf,WAKE;AAAG,qBAAU;AAAb,UALF,CADF;AASD;AACF;;;EAzC6BG,MAAMC,S;;;sBAAzBjB,U;;;;SACQ;AACjBW,eAAW,mBAAUO,MADJ;AAEjBJ,UAAM,mBAAUI,MAFC;AAGjBL,iBAAa,mBAAUM;AAHN;;;AA2CrB,IAAMC;AAAA;AAAmB,0BAAOC,CAA1B;AAAA;AAAA;AAAA,4CACG,UAACX,KAAD;AAAA,SAAYA,MAAMG,WAAN,aAAuBH,MAAMG,WAA7B,gBAAZ;AAAA,CADH,CAAN","file":"/Users/eve/development/force/src/desktop/apps/article/components/EditButton.js","sourceRoot":"/Users/eve/development/force","sourcesContent":["import * as React from 'react'\nimport ChannelMemberQuery from 'desktop/apps/article/queries/channelMember'\nimport PropTypes from 'prop-types'\nimport { positronql as _positronql } from 'desktop/lib/positronql'\nimport styled from 'styled-components'\nimport { data as _sd } from 'sharify'\nimport { pluck, contains } from 'underscore'\n\n// FIXME: Rewire\nlet sd = _sd\nlet positronql = _positronql\n\nexport class EditButton extends React.Component {\n  static propTypes = {\n    channelId: PropTypes.string,\n    slug: PropTypes.string,\n    positionTop: PropTypes.number,\n  }\n\n  state = {\n    hasButtonState: false,\n  }\n\n  componentDidMount = async () => {\n    const userId = sd.CURRENT_USER && sd.CURRENT_USER.id\n    if (!userId) {\n      return this.setState({ showEditButton: false, hasButtonState: true })\n    }\n    const data = await positronql({ query: ChannelMemberQuery(userId) })\n    if (contains(pluck(data.channels, 'id'), this.props.channelId)) {\n      this.setState({ showEditButton: true, hasButtonState: true })\n    } else {\n      this.setState({ showEditButton: false, hasButtonState: true })\n    }\n  }\n\n  render() {\n    const { hasButtonState, showEditButton } = this.state\n    const { positionTop, slug } = this.props\n\n    if (!hasButtonState || !showEditButton) {\n      return false\n    } else {\n      return (\n        <StyledEditButton\n          target=\"_blank\"\n          href={`${sd.POSITRON_URL}/articles/${slug}/edit`}\n          positionTop={positionTop}\n        >\n          <i className=\"icon-with-black-circle icon-edit\" />\n        </StyledEditButton>\n      )\n    }\n  }\n}\n\nconst StyledEditButton = styled.a`\n  top: ${(props) => (props.positionTop ? `${props.positionTop}px` : `75px`)};\n  position: fixed;\n  right: 20px;\n`\n"]}]}