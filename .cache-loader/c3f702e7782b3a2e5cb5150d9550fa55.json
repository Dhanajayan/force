{"remainingRequest":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js??ref--2-1!/Users/eve/development/force/src/desktop/apps/article/components/InfiniteScrollArticle.js","dependencies":[{"path":"/Users/eve/development/force/src/desktop/apps/article/components/InfiniteScrollArticle.js","mtime":1533652817000},{"path":"/Users/eve/development/force/.babelrc","mtime":1537178749000},{"path":"/Users/eve/development/force/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/eve/development/force/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\n(function () {\n  var enterModule = require('react-hot-loader').enterModule;\n\n  enterModule && enterModule(module);\n})();\n\nimport * as React from 'react';\nimport _ from 'underscore';\nimport PropTypes from 'prop-types';\nimport Waypoint from 'react-waypoint';\nimport styled from 'styled-components';\nimport { data as sd } from 'sharify';\nimport { positronql as _positronql } from \"../../../lib/positronql\";\nimport { Article } from \"@artsy/reaction/dist/Components/Publishing\";\nimport { articlesQuery } from \"../queries/articles\";\nimport { setupFollows, setupFollowButtons } from \"./FollowButton.js\";\nimport { getCurrentUnixTimestamp } from \"@artsy/reaction/dist/Components/Publishing/Constants\"; // FIXME: Rewire\n\nvar positronql = _positronql;\nvar FETCH_TOP_OFFSET = 200;\n\nvar InfiniteScrollArticle =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(InfiniteScrollArticle, _React$Component);\n\n  function InfiniteScrollArticle(props) {\n    var _this;\n\n    _classCallCheck(this, InfiniteScrollArticle);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(InfiniteScrollArticle).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"fetchNextArticles\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var _this$state, articles, following, offset, renderTimes, data;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this$state = _this.state, articles = _this$state.articles, following = _this$state.following, offset = _this$state.offset, renderTimes = _this$state.renderTimes;\n\n              _this.setState({\n                isLoading: true\n              });\n\n              _context.prev = 2;\n              _context.next = 5;\n              return positronql({\n                query: articlesQuery({\n                  offset: offset,\n                  layout: 'standard',\n                  limit: 3,\n                  channel: sd.ARTSY_EDITORIAL_CHANNEL,\n                  omit: _this.props.article.id\n                })\n              });\n\n            case 5:\n              data = _context.sent;\n\n              if (data.articles.length) {\n                _this.setState({\n                  articles: articles.concat(data.articles),\n                  renderTimes: renderTimes.concat([getCurrentUnixTimestamp()]),\n                  isLoading: false,\n                  offset: offset + 3\n                });\n\n                setupFollowButtons(following);\n              } else {\n                _this.setState({\n                  isEnabled: false,\n                  isLoading: false\n                });\n              }\n\n              _context.next = 13;\n              break;\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](2);\n              console.error('(apps/article/InfiniteScrollArticle) Error fetching next article set: ', _context.t0);\n\n              _this.setState({\n                isEnabled: false,\n                isLoading: false,\n                error: true\n              });\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this, [[2, 9]]);\n    })));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderWaypoint\", function () {\n      var _this$state2 = _this.state,\n          isEnabled = _this$state2.isEnabled,\n          isLoading = _this$state2.isLoading,\n          error = _this$state2.error;\n\n      if (isEnabled) {\n        if (!isLoading) {\n          return React.createElement(Waypoint, {\n            onEnter: _this.fetchNextArticles,\n            threshold: 2.0,\n            topOffset: FETCH_TOP_OFFSET\n          });\n        } else if (!error) {\n          return React.createElement(LoadingSpinner, null, React.createElement(\"div\", {\n            className: \"loading-spinner\"\n          }));\n        }\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onEnter\", function (article, _ref2) {\n      var previousPosition = _ref2.previousPosition,\n          currentPosition = _ref2.currentPosition;\n\n      if (previousPosition === 'above' && currentPosition === 'inside') {\n        document.title = article.thumbnail_title;\n        window.history.replaceState({}, article.id, \"/article/\".concat(article.slug));\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onLeave\", function (i, _ref3) {\n      var previousPosition = _ref3.previousPosition,\n          currentPosition = _ref3.currentPosition;\n      var nextArticle = _this.state.articles[i + 1];\n\n      if (nextArticle && previousPosition === 'inside' && currentPosition === 'above') {\n        document.title = nextArticle.thumbnail_title;\n        window.history.replaceState({}, nextArticle.id, \"/article/\".concat(nextArticle.slug));\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"renderContent\", function () {\n      var _this$props = _this.props,\n          slug = _this$props.article.slug,\n          emailSignupUrl = _this$props.emailSignupUrl,\n          isMobile = _this$props.isMobile,\n          showTooltips = _this$props.showTooltips,\n          onOpenAuthModal = _this$props.onOpenAuthModal;\n      var _this$state3 = _this.state,\n          articles = _this$state3.articles,\n          renderTimes = _this$state3.renderTimes;\n      return _.flatten(articles.map(function (article, i) {\n        return React.createElement(\"div\", {\n          key: \"article-\".concat(i)\n        }, React.createElement(Article, {\n          article: article,\n          emailSignupUrl: emailSignupUrl,\n          relatedArticlesForPanel: article.relatedArticlesPanel,\n          relatedArticlesForCanvas: article.relatedArticlesCanvas,\n          isTruncated: i !== 0,\n          isMobile: isMobile,\n          display: article.display,\n          showTooltips: showTooltips,\n          onOpenAuthModal: onOpenAuthModal,\n          renderTime: renderTimes[Math.floor(i / 3)],\n          infiniteScrollEntrySlug: slug\n        }), React.createElement(Waypoint, {\n          onEnter: function onEnter(waypointData) {\n            return _this.onEnter(article, waypointData);\n          },\n          onLeave: function onLeave(waypointData) {\n            return _this.onLeave(i, waypointData);\n          }\n        }));\n      }));\n    });\n\n    _this.state = {\n      isLoading: false,\n      articles: [props.article],\n      offset: 0,\n      error: false,\n      following: setupFollows() || null,\n      isEnabled: true,\n      renderTimes: [props.renderTime]\n    };\n    return _this;\n  }\n\n  _createClass(InfiniteScrollArticle, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      setupFollowButtons(this.state.following);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        id: \"article-root\"\n      }, this.renderContent(), this.renderWaypoint());\n    }\n  }, {\n    key: \"__reactstandin__regenerateByEval\",\n    value: function __reactstandin__regenerateByEval(key, code) {\n      this[key] = eval(code);\n    }\n  }]);\n\n  return InfiniteScrollArticle;\n}(React.Component);\n\n_defineProperty(InfiniteScrollArticle, \"propTypes\", {\n  article: PropTypes.object,\n  emailSignupUrl: PropTypes.string,\n  isMobile: PropTypes.bool,\n  showTooltips: PropTypes.bool,\n  onOpenAuthModal: PropTypes.func,\n  renderTime: PropTypes.number\n});\n\nexport { InfiniteScrollArticle as default };\nexport var LoadingSpinner =\n/*#__PURE__*/\nstyled.div.withConfig({\n  displayName: \"InfiniteScrollArticle__LoadingSpinner\",\n  componentId: \"s17nwnks-0\"\n})([\"position:relative;padding:100px;\"]);\n;\n\n(function () {\n  var reactHotLoader = require('react-hot-loader').default;\n\n  var leaveModule = require('react-hot-loader').leaveModule;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(positronql, \"positronql\", \"/Users/eve/development/force/src/desktop/apps/article/components/InfiniteScrollArticle.js\");\n  reactHotLoader.register(FETCH_TOP_OFFSET, \"FETCH_TOP_OFFSET\", \"/Users/eve/development/force/src/desktop/apps/article/components/InfiniteScrollArticle.js\");\n  reactHotLoader.register(InfiniteScrollArticle, \"InfiniteScrollArticle\", \"/Users/eve/development/force/src/desktop/apps/article/components/InfiniteScrollArticle.js\");\n  reactHotLoader.register(LoadingSpinner, \"LoadingSpinner\", \"/Users/eve/development/force/src/desktop/apps/article/components/InfiniteScrollArticle.js\");\n  leaveModule(module);\n})();\n\n;",{"version":3,"sources":["/Users/eve/development/force/src/desktop/apps/article/components/InfiniteScrollArticle.js"],"names":["React","_","PropTypes","Waypoint","styled","data","sd","positronql","_positronql","Article","articlesQuery","setupFollows","setupFollowButtons","getCurrentUnixTimestamp","FETCH_TOP_OFFSET","InfiniteScrollArticle","props","state","articles","following","offset","renderTimes","setState","isLoading","query","layout","limit","channel","ARTSY_EDITORIAL_CHANNEL","omit","article","id","length","concat","isEnabled","console","error","fetchNextArticles","previousPosition","currentPosition","document","title","thumbnail_title","window","history","replaceState","slug","i","nextArticle","emailSignupUrl","isMobile","showTooltips","onOpenAuthModal","flatten","map","relatedArticlesPanel","relatedArticlesCanvas","display","Math","floor","waypointData","onEnter","onLeave","renderTime","renderContent","renderWaypoint","Component","object","string","bool","func","number","LoadingSpinner","div"],"mappings":"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","sourcesContent":["import * as React from 'react'\nimport _ from 'underscore'\nimport PropTypes from 'prop-types'\nimport Waypoint from 'react-waypoint'\nimport styled from 'styled-components'\nimport { data as sd } from 'sharify'\nimport { positronql as _positronql } from 'desktop/lib/positronql'\nimport { Article } from 'reaction/Components/Publishing'\nimport { articlesQuery } from 'desktop/apps/article/queries/articles'\nimport { setupFollows, setupFollowButtons } from './FollowButton.js'\nimport { getCurrentUnixTimestamp } from 'reaction/Components/Publishing/Constants'\n\n// FIXME: Rewire\nlet positronql = _positronql\n\nconst FETCH_TOP_OFFSET = 200\n\nexport default class InfiniteScrollArticle extends React.Component {\n  static propTypes = {\n    article: PropTypes.object,\n    emailSignupUrl: PropTypes.string,\n    isMobile: PropTypes.bool,\n    showTooltips: PropTypes.bool,\n    onOpenAuthModal: PropTypes.func,\n    renderTime: PropTypes.number,\n  }\n\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n      articles: [props.article],\n      offset: 0,\n      error: false,\n      following: setupFollows() || null,\n      isEnabled: true,\n      renderTimes: [props.renderTime],\n    }\n  }\n\n  componentDidMount() {\n    setupFollowButtons(this.state.following)\n  }\n\n  fetchNextArticles = async () => {\n    const { articles, following, offset, renderTimes } = this.state\n\n    this.setState({\n      isLoading: true,\n    })\n\n    try {\n      const data = await positronql({\n        query: articlesQuery({\n          offset,\n          layout: 'standard',\n          limit: 3,\n          channel: sd.ARTSY_EDITORIAL_CHANNEL,\n          omit: this.props.article.id,\n        }),\n      })\n\n      if (data.articles.length) {\n        this.setState({\n          articles: articles.concat(data.articles),\n          renderTimes: renderTimes.concat([getCurrentUnixTimestamp()]),\n          isLoading: false,\n          offset: offset + 3,\n        })\n        setupFollowButtons(following)\n      } else {\n        this.setState({\n          isEnabled: false,\n          isLoading: false,\n        })\n      }\n    } catch (error) {\n      console.error(\n        '(apps/article/InfiniteScrollArticle) Error fetching next article set: ',\n        error\n      )\n\n      this.setState({\n        isEnabled: false,\n        isLoading: false,\n        error: true,\n      })\n    }\n  }\n\n  renderWaypoint = () => {\n    const { isEnabled, isLoading, error } = this.state\n\n    if (isEnabled) {\n      if (!isLoading) {\n        return (\n          <Waypoint\n            onEnter={this.fetchNextArticles}\n            threshold={2.0}\n            topOffset={FETCH_TOP_OFFSET}\n          />\n        )\n      } else if (!error) {\n        return (\n          <LoadingSpinner>\n            <div className=\"loading-spinner\" />\n          </LoadingSpinner>\n        )\n      }\n    }\n  }\n\n  onEnter = (article, { previousPosition, currentPosition }) => {\n    if (previousPosition === 'above' && currentPosition === 'inside') {\n      document.title = article.thumbnail_title\n      window.history.replaceState({}, article.id, `/article/${article.slug}`)\n    }\n  }\n\n  onLeave = (i, { previousPosition, currentPosition }) => {\n    const nextArticle = this.state.articles[i + 1]\n\n    if (\n      nextArticle &&\n      previousPosition === 'inside' &&\n      currentPosition === 'above'\n    ) {\n      document.title = nextArticle.thumbnail_title\n      window.history.replaceState(\n        {},\n        nextArticle.id,\n        `/article/${nextArticle.slug}`\n      )\n    }\n  }\n\n  renderContent = () => {\n    const {\n      article: { slug },\n      emailSignupUrl,\n      isMobile,\n      showTooltips,\n      onOpenAuthModal,\n    } = this.props\n    const { articles, renderTimes } = this.state\n\n    return _.flatten(\n      articles.map((article, i) => {\n        return (\n          <div key={`article-${i}`}>\n            <Article\n              article={article}\n              emailSignupUrl={emailSignupUrl}\n              relatedArticlesForPanel={article.relatedArticlesPanel}\n              relatedArticlesForCanvas={article.relatedArticlesCanvas}\n              isTruncated={i !== 0}\n              isMobile={isMobile}\n              display={article.display}\n              showTooltips={showTooltips}\n              onOpenAuthModal={onOpenAuthModal}\n              renderTime={renderTimes[Math.floor(i / 3)]}\n              infiniteScrollEntrySlug={slug}\n            />\n            <Waypoint\n              onEnter={waypointData => this.onEnter(article, waypointData)}\n              onLeave={waypointData => this.onLeave(i, waypointData)}\n            />\n          </div>\n        )\n      })\n    )\n  }\n\n  render() {\n    return (\n      <div id=\"article-root\">\n        {this.renderContent()}\n        {this.renderWaypoint()}\n      </div>\n    )\n  }\n}\n\nexport const LoadingSpinner = styled.div`\n  position: relative;\n  padding: 100px;\n`\n"]}]}